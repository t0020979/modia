<!DOCTYPE html>
<html lang="ru">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Modia ‚Äî –¢–µ—Å—Ç ValidationComponent (–°–æ–±—ã—Ç–∏—è-—Ö—É–∫–∏)</title>

  <!-- ‚úÖ jQuery CDN (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û) -->
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>

  <!-- ‚úÖ Bootstrap 4 CDN -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">

  <!-- ‚úÖ –ü—Ä–∏–º–µ—Ä—ã CSS (2 —É—Ä–æ–≤–Ω—è –≤–≤–µ—Ä—Ö) -->
  <link rel="stylesheet" href="../../examples.css">

  <!-- ‚úÖ Modia CSS (—Å–∫—Ä—ã–≤–∞–µ—Ç —à–∞–±–ª–æ–Ω—ã –æ—à–∏–±–æ–∫) -->
  <link rel="stylesheet" href="../../../modia/modia.css">

  <style>
    .test-form {
      max-width: 500px;
      margin: 20px 0;
      padding: 20px;
      border: 1px solid #ddd;
      border-radius: 5px;
    }

    .form-status {
      margin-top: 15px;
      padding: 10px;
      border-radius: 3px;
      font-weight: 500;
    }

    .form-status.success {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }

    .form-status.error {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }

    .form-status.pending {
      background: #fff3cd;
      color: #856404;
      border: 1px solid #ffeeba;
    }

    .console-log-container {
      position: relative;
    }

    .btn-copy-log {
      position: absolute;
      top: 5px;
      right: 5px;
      padding: 2px 8px;
      font-size: 11px;
      z-index: 10;
    }

    .event-tracker {
      background: #f8f9fa;
      border: 1px solid #dee2e6;
      padding: 10px;
      font-family: monospace;
      font-size: 12px;
      margin: 10px 0;
      max-height: 200px;
      overflow-y: auto;
    }

    .event-entry {
      padding: 3px 0;
      border-bottom: 1px solid #eee;
    }

    .event-entry:last-child {
      border-bottom: none;
    }

    .event-before {
      color: #007bff;
    }

    .event-validated {
      color: #28a745;
    }

    .event-valid {
      color: #28a745;
      font-weight: bold;
    }

    .event-invalid {
      color: #dc3545;
      font-weight: bold;
    }

    .event-manual {
      color: #17a2b8;
    }

    .hook-status-box {
      background: #e7f3ff;
      border-left: 4px solid #007bff;
      padding: 10px;
      margin: 10px 0;
    }
  </style>
</head>

<body>
  <div class="container mt-5">
    <h1>üß™ –¢–µ—Å—Ç ValidationComponent</h1>
    <p class="text-muted">–°–æ–±—ã—Ç–∏—è-—Ö—É–∫–∏ ‚Äî –∫–∞—Å—Ç–æ–º–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏</p>

    <!-- ============================================================ -->
    <!-- –°–ï–ö–¶–ò–Ø 1: –ë–∞–∑–æ–≤—ã–µ —Ö—É–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ -->
    <!-- ============================================================ -->
    <div class="test-section">
      <h3>üìç –°–µ–∫—Ü–∏—è 1: –ë–∞–∑–æ–≤—ã–µ —Ö—É–∫–∏ (beforeValidate, validated, valid, invalid)</h3>

      <div class="expected-result">
        <h4>‚úÖ –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:</h4>
        <ul>
          <li><code>validation:beforeValidate</code> ‚Äî –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º –≤–∞–ª–∏–¥–∞—Ü–∏–∏</li>
          <li><code>validation:validated</code> ‚Äî –ø–æ—Å–ª–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Å <code>{ isValid }</code></li>
          <li><code>validation:valid</code> ‚Äî –µ—Å–ª–∏ –≤—Å–µ –ø–æ–ª—è –≤–∞–ª–∏–¥–Ω—ã</li>
          <li><code>validation:invalid</code> ‚Äî –µ—Å–ª–∏ –µ—Å—Ç—å –æ—à–∏–±–∫–∏ —Å <code>{ errors: [...] }</code></li>
          <li>–°–æ–±—ã—Ç–∏—è —Ç—Ä–∏–≥–≥–µ—Ä—è—Ç—Å—è –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ</li>
        </ul>
      </div>

      <div class="instruction-box">
        <strong>üìã –†—É—á–Ω–æ–π —Ç–µ—Å—Ç:</strong><br>
        1. –û—Å—Ç–∞–≤—å—Ç–µ –ø–æ–ª—è –ø—É—Å—Ç—ã–º–∏ ‚Üí –Ω–∞–∂–º–∏—Ç–µ <code>üìù –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å</code><br>
        2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç—Ä–µ–∫–µ—Ä —Å–æ–±—ã—Ç–∏–π ‚Äî –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å <code>beforeValidate</code>, <code>validated</code>,
        <code>invalid</code><br>
        3. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–æ–ª—è ‚Üí –Ω–∞–∂–º–∏—Ç–µ <code>üìù –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å</code><br>
        4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç—Ä–µ–∫–µ—Ä ‚Äî –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å <code>beforeValidate</code>, <code>validated</code>, <code>valid</code>
      </div>

      <div class="hook-status-box">
        <strong>üìä –°—Ç–∞—Ç—É—Å —Ö—É–∫–æ–≤:</strong><br>
        <span id="hook-before-validate">‚ö™ beforeValidate: 0</span> |
        <span id="hook-validated">‚ö™ validated: 0</span> |
        <span id="hook-valid">‚ö™ valid: 0</span> |
        <span id="hook-invalid">‚ö™ invalid: 0</span>
      </div>

      <form id="form-hooks-1" data-component="validation" class="test-form">
        <div class="form-group">
          <label for="hook-email">Email *</label>
          <input type="email" id="hook-email" name="email" class="form-control" required>
        </div>

        <div class="form-group">
          <label for="hook-name">–ò–º—è *</label>
          <input type="text" id="hook-name" name="name" class="form-control" required>
        </div>

        <div class="error-templates">
          <span class="text-danger" data-rule="required">–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ</span>
          <span class="text-danger" data-rule="email">–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π email</span>
        </div>

        <div class="form-group mt-3">
          <button type="submit" class="btn btn-primary btn-sm">üìù –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å</button>
          <button type="button" class="btn btn-outline-danger btn-sm" id="btn-clear-hooks-1">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å
            –æ—à–∏–±–∫–∏</button>
        </div>
      </form>

      <div id="form-hooks-1-status" class="form-status pending">–°—Ç–∞—Ç—É—Å: –û–∂–∏–¥–∞–Ω–∏–µ...</div>
      <div class="event-tracker" id="event-tracker-1">
        <div class="text-muted"><small>–û–∂–∏–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π...</small></div>
      </div>

      <div class="test-buttons mt-3">
        <button class="btn btn-success" id="btn-auto-test-section-1">
          ‚ñ∂Ô∏è –ê–≤—Ç–æ-—Ç–µ—Å—Ç —Å–µ–∫—Ü–∏–∏ 1
        </button>
      </div>

      <div id="test-result-1" class="test-result pending">–û–∂–∏–¥–∞–Ω–∏–µ...</div>
    </div>

    <!-- ============================================================ -->
    <!-- –°–ï–ö–¶–ò–Ø 2: –û—Ç–º–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ beforeValidate -->
    <!-- ============================================================ -->
    <div class="test-section">
      <h3>üìç –°–µ–∫—Ü–∏—è 2: –û—Ç–º–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (beforeValidate.preventDefault())</h3>

      <div class="expected-result">
        <h4>‚úÖ –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:</h4>
        <ul>
          <li><code>event.preventDefault()</code> –≤ <code>beforeValidate</code> –æ—Ç–º–µ–Ω—è–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏—é</li>
          <li>–§–æ—Ä–º–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –±–µ–∑ –≤–∞–ª–∏–¥–∞—Ü–∏–∏</li>
          <li>–°–æ–±—ã—Ç–∏—è <code>validated</code>, <code>valid</code>, <code>invalid</code> –ù–ï —Ç—Ä–∏–≥–≥–µ—Ä—è—Ç—Å—è</li>
          <li>–ü–æ–ª–µ–∑–Ω–æ –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –ø–µ—Ä–µ–¥ –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π</li>
        </ul>
      </div>

      <div class="instruction-box">
        <strong>üìã –†—É—á–Ω–æ–π —Ç–µ—Å—Ç:</strong><br>
        1. –í–∫–ª—é—á–∏—Ç–µ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å <code>üîò –û—Ç–∫–ª—é—á–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é</code><br>
        2. –û—Å—Ç–∞–≤—å—Ç–µ –ø–æ–ª—è –ø—É—Å—Ç—ã–º–∏ ‚Üí –Ω–∞–∂–º–∏—Ç–µ <code>üìù –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å</code><br>
        3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ ‚Äî –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ø—Ä–æ–ø—É—â–µ–Ω–∞<br>
        4. –í—ã–∫–ª—é—á–∏—Ç–µ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å ‚Üí –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–Ω–æ–≤–∞
      </div>

      <div class="hook-status-box">
        <strong>üîß –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:</strong><br>
        <div class="form-check">
          <input type="checkbox" class="form-check-input" id="chk-disable-validation">
          <label class="form-check-label" for="chk-disable-validation">
            üîò –û—Ç–∫–ª—é—á–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é (—á–µ—Ä–µ–∑ beforeValidate)
          </label>
        </div>
      </div>

      <form id="form-hooks-2" data-component="validation" class="test-form">
        <div class="form-group">
          <label for="hook-field-2">–ü–æ–ª–µ *</label>
          <input type="text" id="hook-field-2" name="field" class="form-control" required>
        </div>

        <div class="error-templates">
          <span class="text-danger" data-rule="required">–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ</span>
        </div>

        <div class="form-group mt-3">
          <button type="submit" class="btn btn-primary btn-sm">üìù –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å</button>
        </div>
      </form>

      <div id="form-hooks-2-status" class="form-status pending">–°—Ç–∞—Ç—É—Å: –û–∂–∏–¥–∞–Ω–∏–µ...</div>
      <div class="event-tracker" id="event-tracker-2">
        <div class="text-muted"><small>–û–∂–∏–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π...</small></div>
      </div>

      <div class="test-buttons mt-3">
        <button class="btn btn-success" id="btn-auto-test-section-2">
          ‚ñ∂Ô∏è –ê–≤—Ç–æ-—Ç–µ—Å—Ç —Å–µ–∫—Ü–∏–∏ 2
        </button>
      </div>

      <div id="test-result-2" class="test-result pending">–û–∂–∏–¥–∞–Ω–∏–µ...</div>
    </div>

    <!-- ============================================================ -->
    <!-- –°–ï–ö–¶–ò–Ø 3: –°–æ–±—ã—Ç–∏–µ validation:manual-check -->
    <!-- ============================================================ -->
    <div class="test-section">
      <h3>üìç –°–µ–∫—Ü–∏—è 3: –°–æ–±—ã—Ç–∏–µ validation:manual-check (–∫–Ω–æ–ø–∫–∞ [data-validate])</h3>

      <div class="expected-result">
        <h4>‚úÖ –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:</h4>
        <ul>
          <li>–ö–ª–∏–∫ –Ω–∞ <code>[data-validate]</code> —Ç—Ä–∏–≥–≥–µ—Ä–∏—Ç <code>validation:manual-check</code></li>
          <li>–°–æ–±—ã—Ç–∏–µ —Å–æ–¥–µ—Ä–∂–∏—Ç <code>{ isValid }</code></li>
          <li>–§–æ—Ä–º–∞ –ù–ï –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è (—Ç–æ–ª—å–∫–æ –≤–∞–ª–∏–¥–∞—Ü–∏—è)</li>
          <li>–ü–æ–ª–µ–∑–Ω–æ –¥–ª—è –º–æ–¥–∞–ª–æ–∫ –∏ AJAX-—Ñ–æ—Ä–º</li>
        </ul>
      </div>

      <div class="instruction-box">
        <strong>üìã –†—É—á–Ω–æ–π —Ç–µ—Å—Ç:</strong><br>
        1. –ù–∞–∂–º–∏—Ç–µ <code>üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å (button)</code> ‚Üí —Å–æ–±—ã—Ç–∏–µ <code>manual-check</code><br>
        2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç—Ä–µ–∫–µ—Ä —Å–æ–±—ã—Ç–∏–π<br>
        3. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–æ–ª–µ ‚Üí –Ω–∞–∂–º–∏—Ç–µ —Å–Ω–æ–≤–∞ ‚Üí —É—Å–ø–µ—Ö
      </div>

      <div class="hook-status-box">
        <strong>üìä –°—Ç–∞—Ç—É—Å —Ö—É–∫–æ–≤:</strong><br>
        <span id="hook-manual-check">‚ö™ manual-check: 0</span>
      </div>

      <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä (–Ω–µ —Ñ–æ—Ä–º–∞!) –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –º–æ–¥–∞–ª–∫–∏ -->
      <div id="container-hooks-3" data-component="validation" class="test-form">
        <div class="form-group">
          <label for="hook-field-3">–ü–æ–ª–µ *</label>
          <input type="text" id="hook-field-3" name="field" class="form-control" required>
        </div>

        <div class="error-templates">
          <span class="text-danger" data-rule="required">–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ</span>
        </div>

        <div class="form-group mt-3">
          <button type="button" class="btn btn-success btn-sm" data-validate>üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å (button)</button>
          <button type="button" class="btn btn-outline-danger btn-sm" id="btn-clear-hooks-3">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å</button>
        </div>
      </div>

      <div id="container-hooks-3-status" class="form-status pending">–°—Ç–∞—Ç—É—Å: –û–∂–∏–¥–∞–Ω–∏–µ...</div>
      <div class="event-tracker" id="event-tracker-3">
        <div class="text-muted"><small>–û–∂–∏–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π...</small></div>
      </div>

      <div class="test-buttons mt-3">
        <button class="btn btn-success" id="btn-auto-test-section-3">
          ‚ñ∂Ô∏è –ê–≤—Ç–æ-—Ç–µ—Å—Ç —Å–µ–∫—Ü–∏–∏ 3
        </button>
      </div>

      <div id="test-result-3" class="test-result pending">–û–∂–∏–¥–∞–Ω–∏–µ...</div>
    </div>

    <!-- ============================================================ -->
    <!-- –°–ï–ö–¶–ò–Ø 4: –°–æ–±—ã—Ç–∏–µ validation:field-added -->
    <!-- ============================================================ -->
    <div class="test-section">
      <h3>üìç –°–µ–∫—Ü–∏—è 4: –°–æ–±—ã—Ç–∏–µ validation:field-added (–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –ø–æ–ª—è)</h3>

      <div class="expected-result">
        <h4>‚úÖ –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:</h4>
        <ul>
          <li>–¢—Ä–∏–≥–≥–µ—Ä <code>validation:field-added</code> –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –ø–æ–ª—è</li>
          <li>–°–æ–±—ã—Ç–∏–µ —Å–æ–¥–µ—Ä–∂–∏—Ç <code>{ field: HTMLElement }</code></li>
          <li>–ù–æ–≤–æ–µ –ø–æ–ª–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è</li>
          <li>–ü–æ–ª–µ–∑–Ω–æ –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö —Ñ–æ—Ä–º</li>
        </ul>
      </div>

      <div class="instruction-box">
        <strong>üìã –†—É—á–Ω–æ–π —Ç–µ—Å—Ç:</strong><br>
        1. –ù–∞–∂–º–∏—Ç–µ <code>‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ</code> ‚Üí —Å–æ–±—ã—Ç–∏–µ <code>field-added</code><br>
        2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç—Ä–µ–∫–µ—Ä —Å–æ–±—ã—Ç–∏–π<br>
        3. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –Ω–æ–≤–æ–µ –ø–æ–ª–µ ‚Üí –≤–∞–ª–∏–¥–∏—Ä—É–π—Ç–µ ‚Üí —É—Å–ø–µ—Ö
      </div>

      <div class="hook-status-box">
        <strong>üìä –°—Ç–∞—Ç—É—Å —Ö—É–∫–æ–≤:</strong><br>
        <span id="hook-field-added">‚ö™ field-added: 0</span>
      </div>

      <form id="form-hooks-4" data-component="validation" class="test-form">
        <div id="dynamic-fields-container-4">
          <div class="form-group">
            <label>–ü–æ–ª–µ 1 *</label>
            <input type="text" name="dynamic_field[]" class="form-control" required>
          </div>
        </div>

        <div class="error-templates">
          <span class="text-danger" data-rule="required">–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ</span>
        </div>

        <div class="form-group mt-3">
          <button type="button" class="btn btn-success btn-sm" id="btn-add-field-4">‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ</button>
          <button type="button" class="btn btn-primary btn-sm" id="btn-validate-4">üìù –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å</button>
        </div>
      </form>

      <div id="form-hooks-4-status" class="form-status pending">–°—Ç–∞—Ç—É—Å: –û–∂–∏–¥–∞–Ω–∏–µ...</div>
      <div class="event-tracker" id="event-tracker-4">
        <div class="text-muted"><small>–û–∂–∏–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π...</small></div>
      </div>

      <div class="test-buttons mt-3">
        <button class="btn btn-success" id="btn-auto-test-section-4">
          ‚ñ∂Ô∏è –ê–≤—Ç–æ-—Ç–µ—Å—Ç —Å–µ–∫—Ü–∏–∏ 4
        </button>
      </div>

      <div id="test-result-4" class="test-result pending">–û–∂–∏–¥–∞–Ω–∏–µ...</div>
    </div>

    <!-- ============================================================ -->
    <!-- –ö–û–ù–°–û–õ–¨ –õ–û–ì–ì–ï–†–ê -->
    <!-- ============================================================ -->
    <div class="test-section">
      <h3>üìã –ö–æ–Ω—Å–æ–ª—å –ª–æ–≥–≥–µ—Ä–∞</h3>

      <div class="console-log-container">
        <button class="btn btn-sm btn-outline-secondary btn-copy-log" id="btn-copy-log">
          üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
        </button>
        <div class="event-log" id="console-log" style="max-height: 300px; overflow-y: auto;">
          <div class="text-muted"><small>[00:00:00] –ö–æ–Ω—Å–æ–ª—å –ª–æ–≥–≥–µ—Ä–∞ –≥–æ—Ç–æ–≤–∞...</small></div>
        </div>
      </div>

      <div class="test-buttons mt-2">
        <button class="btn btn-outline-secondary" id="btn-clear-log">üßπ –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥</button>
      </div>
    </div>

    <!-- ============================================================ -->
    <!-- –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ö–ù–û–ü–ö–ò -->
    <!-- ============================================================ -->
    <div class="test-buttons mt-4">
      <button class="btn btn-success btn-lg" id="btn-auto-test-all">
        ‚ñ∂Ô∏è –ó–∞–ø—É—Å—Ç–∏—Ç—å –∞–≤—Ç–æ-—Ç–µ—Å—Ç –≤—Å–µ—Ö —Å–µ–∫—Ü–∏–π
      </button>
    </div>

    <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
    <div class="mt-4">
      <a href="test-07-hidden-fields.html" class="btn btn-outline-secondary">
        ‚Üê –ü—Ä–µ–¥—ã–¥—É—â–∏–π —Ç–µ—Å—Ç: –°–∫—Ä—ã—Ç—ã–µ –ø–æ–ª—è
      </a>
      <a href="test-09-form-data.html" class="btn btn-outline-primary">
        ‚Üí –°–ª–µ–¥—É—é—â–∏–π —Ç–µ—Å—Ç: getFormData() –∏ getErrors()
      </a>
    </div>
  </div>

  <!-- ‚úÖ Modia Index (3 —É—Ä–æ–≤–Ω—è –≤–≤–µ—Ä—Ö!) -->
  <script type="module" src="../../../modia/index.js"></script>

  <!-- ‚úÖ –¢–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç -->
  <script type="module">
    // ============================================================
    // –£–¢–ò–õ–ò–¢–´
    // ============================================================

    let testRunning = false;

    // –°—á—ë—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
    const hookCounts = {
      beforeValidate: 0,
      validated: 0,
      valid: 0,
      invalid: 0,
      manualCheck: 0,
      fieldAdded: 0
    };

    function log(message, type = 'info') {
      const $log = $('#console-log');
      const timestamp = new Date().toLocaleTimeString('ru-RU');
      const color = type === 'error' ? 'text-danger'
        : type === 'success' ? 'text-success'
          : 'text-muted';
      $log.append(`<div class="${color}"><small>[${timestamp}] ${message}</small></div>`);
      $log.scrollTop($log[0].scrollHeight);
      console.log(`[Hooks Events Test] ${message}`);
    }

    function sleep(ms) {
      return new Promise(resolve => setTimeout(resolve, ms));
    }

    function setFormStatus(formId, status, message) {
      const $status = $(`#${formId}-status`);
      $status.removeClass('success error pending').addClass(status);
      $status.text(`–°—Ç–∞—Ç—É—Å: ${message}`);
    }

    function addEventEntry(trackerId, eventType, data = '') {
      const $tracker = $(`#${trackerId}`);
      const timestamp = new Date().toLocaleTimeString('ru-RU');
      const eventClass = `event-${eventType.toLowerCase().replace(':', '-')}`;
      $tracker.append(
        `<div class="event-entry ${eventClass}">` +
        `<small>[${timestamp}] <strong>${eventType}</strong>${data ? ' ‚Üí ' + data : ''}</small></div>`
      );
      $tracker.scrollTop($tracker[0].scrollHeight);
    }

    function clearEventTracker(trackerId) {
      $(`#${trackerId}`).html('<div class="text-muted"><small>–û–∂–∏–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π...</small></div>');
    }

    function updateHookStatus(hookName, count) {
      const $el = $(`#hook-${hookName}`);
      const icon = count > 0 ? 'üü¢' : '‚ö™';
      $el.text(`${icon} ${hookName}: ${count}`);
    }

    // ============================================================
    // –ö–û–ü–ò–†–û–í–ê–ù–ò–ï –õ–û–ì–ê –í –ë–£–§–ï–† –û–ë–ú–ï–ù–ê
    // ============================================================

    function copyLogToClipboard() {
      const $log = $('#console-log');
      const lines = [];
      $log.find('div').each(function () {
        lines.push($(this).text().trim());
      });
      const text = lines.join('\n');

      if (!text) {
        log('‚ùå –ù–µ—á–µ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å ‚Äî –ª–æ–≥ –ø—É—Å—Ç', 'error');
        return false;
      }

      if (navigator.clipboard && window.isSecureContext) {
        navigator.clipboard.writeText(text).then(() => {
          log('‚úÖ –õ–æ–≥ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞', 'success');
          const $btn = $('#btn-copy-log');
          const originalText = $btn.text();
          $btn.text('‚úÖ –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!').prop('disabled', true);
          setTimeout(() => {
            $btn.text(originalText).prop('disabled', false);
          }, 2000);
        }).catch(err => {
          log(`‚ùå –û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è: ${err.message}`, 'error');
        });
      } else {
        const $textarea = $('<textarea>').val(text).css({
          position: 'absolute',
          left: '-9999px',
          top: '-9999px'
        }).appendTo('body');

        $textarea[0].select();
        try {
          document.execCommand('copy');
          log('‚úÖ –õ–æ–≥ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω (fallback)', 'success');
        } catch (err) {
          log(`‚ùå –û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è: ${err.message}`, 'error');
        }
        $textarea.remove();
      }

      return true;
    }

    // ============================================================
    // –°–ï–ö–¶–ò–Ø 1: –ë–∞–∑–æ–≤—ã–µ —Ö—É–∫–∏
    // ============================================================

    $(document).ready(function () {
      log('DOM –≥–æ—Ç–æ–≤, –æ–∂–∏–¥–∞–Ω–∏–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Modia...', 'info');

      setTimeout(function () {
        log('Modia –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω', 'success');

        const $form1 = $('#form-hooks-1');
        const comp1 = $form1.data('modia-component');

        if (comp1) {
          log(`‚úÖ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –Ω–∞–π–¥–µ–Ω: ${comp1.constructor.name}`, 'success');
        }

        // –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Å–æ–±—ã—Ç–∏—è
        $form1.on('validation:beforeValidate', function (e) {
          hookCounts.beforeValidate++;
          updateHookStatus('before-validate', hookCounts.beforeValidate);
          addEventEntry('event-tracker-1', 'validation:beforeValidate');
          log('üì¨ –°–æ–±—ã—Ç–∏–µ: validation:beforeValidate', 'info');
        });

        $form1.on('validation:validated', function (e, data) {
          hookCounts.validated++;
          updateHookStatus('validated', hookCounts.validated);
          addEventEntry('event-tracker-1', 'validation:validated', `isValid=${data.isValid}`);
          log(`üì¨ –°–æ–±—ã—Ç–∏–µ: validation:validated (isValid=${data.isValid})`, 'info');
        });

        $form1.on('validation:valid', function (e) {
          hookCounts.valid++;
          updateHookStatus('valid', hookCounts.valid);
          addEventEntry('event-tracker-1', 'validation:valid');
          log('üì¨ –°–æ–±—ã—Ç–∏–µ: validation:valid', 'success');
          setFormStatus('form-hooks-1', 'success', '–§–æ—Ä–º–∞ –≤–∞–ª–∏–¥–Ω–∞!');
        });

        $form1.on('validation:invalid', function (e, data) {
          hookCounts.invalid++;
          updateHookStatus('invalid', hookCounts.invalid);
          addEventEntry('event-tracker-1', 'validation:invalid', `–æ—à–∏–±–æ–∫: ${data.errors.length}`);
          log(`üì¨ –°–æ–±—ã—Ç–∏–µ: validation:invalid (–æ—à–∏–±–æ–∫: ${data.errors.length})`, 'error');
          setFormStatus('form-hooks-1', 'error', `–û—à–∏–±–æ–∫: ${data.errors.length}`);
        });

        // –û—á–∏—Å—Ç–∫–∞ –æ—à–∏–±–æ–∫
        $('#btn-clear-hooks-1').on('click', function () {
          if (comp1) {
            comp1.clearErrors();
            log('üóëÔ∏è –û—à–∏–±–∫–∏ –æ—á–∏—â–µ–Ω—ã', 'info');
            setFormStatus('form-hooks-1', 'pending', '–û—à–∏–±–∫–∏ –æ—á–∏—â–µ–Ω—ã');
          }
        });
      }, 500);
    });

    // ============================================================
    // –°–ï–ö–¶–ò–Ø 2: –û—Ç–º–µ–Ω–∞ —á–µ—Ä–µ–∑ beforeValidate
    // ============================================================

    $(document).ready(function () {
      setTimeout(function () {
        const $form2 = $('#form-hooks-2');
        const comp2 = $form2.data('modia-component');

        let disableValidation = false;

        // –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ beforeValidate —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –æ—Ç–º–µ–Ω—ã
        $form2.on('validation:beforeValidate', function (e) {
          hookCounts.beforeValidate++;
          updateHookStatus('before-validate', hookCounts.beforeValidate);
          addEventEntry('event-tracker-2', 'validation:beforeValidate');
          log('üì¨ –°–æ–±—ã—Ç–∏–µ: validation:beforeValidate', 'info');

          if (disableValidation) {
            log('‚ö†Ô∏è –í–∞–ª–∏–¥–∞—Ü–∏—è –æ—Ç–º–µ–Ω–µ–Ω–∞ —á–µ—Ä–µ–∑ preventDefault()', 'warn');
            addEventEntry('event-tracker-2', 'validation:beforeValidate', '‚ö†Ô∏è –û–¢–ú–ï–ù–ï–ù–û');
            e.preventDefault();
          }
        });

        $form2.on('validation:validated', function (e, data) {
          hookCounts.validated++;
          updateHookStatus('validated', hookCounts.validated);
          addEventEntry('event-tracker-2', 'validation:validated', `isValid=${data.isValid}`);
          log(`üì¨ –°–æ–±—ã—Ç–∏–µ: validation:validated (isValid=${data.isValid})`, 'info');
        });

        $form2.on('validation:valid', function (e) {
          hookCounts.valid++;
          updateHookStatus('valid', hookCounts.valid);
          addEventEntry('event-tracker-2', 'validation:valid');
          log('üì¨ –°–æ–±—ã—Ç–∏–µ: validation:valid', 'success');
          setFormStatus('form-hooks-2', 'success', '–§–æ—Ä–º–∞ –≤–∞–ª–∏–¥–Ω–∞!');
        });

        $form2.on('validation:invalid', function (e, data) {
          hookCounts.invalid++;
          updateHookStatus('invalid', hookCounts.invalid);
          addEventEntry('event-tracker-2', 'validation:invalid', `–æ—à–∏–±–æ–∫: ${data.errors.length}`);
          log(`üì¨ –°–æ–±—ã—Ç–∏–µ: validation:invalid (–æ—à–∏–±–æ–∫: ${data.errors.length})`, 'error');
          setFormStatus('form-hooks-2', 'error', `–û—à–∏–±–æ–∫: ${data.errors.length}`);
        });

        // –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –æ—Ç–∫–ª—é—á–µ–Ω–∏—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
        $('#chk-disable-validation').on('change', function () {
          disableValidation = $(this).is(':checked');
          log(`üîß –û—Ç–º–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏: ${disableValidation ? '–í–ö–õ' : '–í–´–ö–õ'}`, 'info');
        });
      }, 500);
    });

    // ============================================================
    // –°–ï–ö–¶–ò–Ø 3: validation:manual-check
    // ============================================================

    $(document).ready(function () {
      setTimeout(function () {
        const $container3 = $('#container-hooks-3');
        const comp3 = $container3.data('modia-component');

        // –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ manual-check
        $container3.on('validation:manual-check', function (e, data) {
          hookCounts.manualCheck++;
          updateHookStatus('manual-check', hookCounts.manualCheck);
          addEventEntry('event-tracker-3', 'validation:manual-check', `isValid=${data.isValid}`);
          log(`üì¨ –°–æ–±—ã—Ç–∏–µ: validation:manual-check (isValid=${data.isValid})`, 'info');

          if (data.isValid) {
            setFormStatus('container-hooks-3', 'success', '–í–∞–ª–∏–¥–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞!');
          } else {
            setFormStatus('container-hooks-3', 'error', '–ï—Å—Ç—å –æ—à–∏–±–∫–∏');
          }
        });

        // –û—á–∏—Å—Ç–∫–∞ –æ—à–∏–±–æ–∫
        $('#btn-clear-hooks-3').on('click', function () {
          if (comp3) {
            comp3.clearErrors();
            log('üóëÔ∏è –û—à–∏–±–∫–∏ –æ—á–∏—â–µ–Ω—ã', 'info');
            setFormStatus('container-hooks-3', 'pending', '–û—à–∏–±–∫–∏ –æ—á–∏—â–µ–Ω—ã');
          }
        });
      }, 500);
    });

    // ============================================================
    // –°–ï–ö–¶–ò–Ø 4: validation:field-added
    // ============================================================

    $(document).ready(function () {
      setTimeout(function () {
        const $form4 = $('#form-hooks-4');
        const comp4 = $form4.data('modia-component');
        let fieldCounter = 1;

        // –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ field-added
        $form4.on('validation:field-added', function (e, data) {
          hookCounts.fieldAdded++;
          updateHookStatus('field-added', hookCounts.fieldAdded);
          addEventEntry('event-tracker-4', 'validation:field-added', `field: ${data.field?.tagName || 'unknown'}`);
          log(`üì¨ –°–æ–±—ã—Ç–∏–µ: validation:field-added`, 'info');
        });

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—è
        $('#btn-add-field-4').on('click', function () {
          fieldCounter++;
          const $newField = $(`
            <div class="form-group dynamic-field">
              <label>–ü–æ–ª–µ ${fieldCounter} *</label>
              <input type="text" name="dynamic_field[]" class="form-control" required>
            </div>
          `);

          $('#dynamic-fields-container-4').append($newField);

          // –¢—Ä–∏–≥–≥–µ—Ä–∏–º —Å–æ–±—ã—Ç–∏–µ –¥–ª—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
          $form4.trigger('validation:field-added', { field: $newField.find('input')[0] });

          log(`‚ûï –ü–æ–ª–µ ${fieldCounter} –¥–æ–±–∞–≤–ª–µ–Ω–æ`, 'success');
        });

        // –í–∞–ª–∏–¥–∞—Ü–∏—è
        $('#btn-validate-4').on('click', function () {
          if (comp4) {
            const isValid = comp4.validate();
            log(`üìù –í–∞–ª–∏–¥–∞—Ü–∏—è: ${isValid}`, isValid ? 'success' : 'error');
            setFormStatus('form-hooks-4', isValid ? 'success' : 'error',
              isValid ? '–í–∞–ª–∏–¥–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞' : '–ï—Å—Ç—å –æ—à–∏–±–∫–∏');
          }
        });
      }, 500);
    });

    // ============================================================
    // –ê–í–¢–û-–¢–ï–°–¢ –°–ï–ö–¶–ò–ò 1
    // ============================================================

    $('#btn-auto-test-section-1').on('click', async function () {
      if (testRunning) return;
      testRunning = true;

      const $btn = $(this);
      $btn.prop('disabled', true).text('‚è≥ –¢–µ—Å—Ç –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è...');

      try {
        log('=== –ê–≤—Ç–æ-—Ç–µ—Å—Ç —Å–µ–∫—Ü–∏–∏ 1: –ù–∞—á–∞–ª–æ ===', 'info');
        clearEventTracker('event-tracker-1');

        const comp1 = $('#form-hooks-1').data('modia-component');
        const beforeCount1 = hookCounts.beforeValidate;

        // –®–∞–≥ 1: –ü—É—Å—Ç–∞—è —Ñ–æ—Ä–º–∞ ‚Üí invalid
        log('–®–∞–≥ 1: –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—É—Å—Ç–æ–π —Ñ–æ—Ä–º—ã...', 'info');
        $('#hook-email').val('');
        $('#hook-name').val('');
        comp1.clearErrors();
        await sleep(300);

        comp1.validate();
        await sleep(300);

        if (hookCounts.invalid > 0 && hookCounts.validated > beforeCount1) {
          log('‚úÖ –®–∞–≥ 1: –°–æ–±—ã—Ç–∏—è invalid –∏ validated —Å—Ä–∞–±–æ—Ç–∞–ª–∏', 'success');
        } else {
          throw new Error('–°–æ–±—ã—Ç–∏—è –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ');
        }

        await sleep(500);

        // –®–∞–≥ 2: –ó–∞–ø–æ–ª–Ω–µ–Ω–Ω–∞—è —Ñ–æ—Ä–º–∞ ‚Üí valid
        log('–®–∞–≥ 2: –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ñ–æ—Ä–º—ã...', 'info');
        $('#hook-email').val('test@example.com');
        $('#hook-name').val('–ò–≤–∞–Ω');
        comp1.clearErrors();
        await sleep(300);

        const validCount1 = hookCounts.valid;
        comp1.validate();
        await sleep(300);

        if (hookCounts.valid > validCount1) {
          log('‚úÖ –®–∞–≥ 2: –°–æ–±—ã—Ç–∏–µ valid —Å—Ä–∞–±–æ—Ç–∞–ª–æ', 'success');
        } else {
          throw new Error('–°–æ–±—ã—Ç–∏–µ valid –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–æ');
        }

        log('=== –ê–≤—Ç–æ-—Ç–µ—Å—Ç —Å–µ–∫—Ü–∏–∏ 1: –£—Å–ø–µ—à–Ω–æ ===', 'success');
        $('#test-result-1').removeClass('pending').addClass('pass')
          .text('‚úÖ –ê–≤—Ç–æ-—Ç–µ—Å—Ç –ø—Ä–æ–π–¥–µ–Ω');

      } catch (error) {
        log(`‚ùå –ê–≤—Ç–æ-—Ç–µ—Å—Ç –ø—Ä–æ–≤–∞–ª–µ–Ω: ${error.message}`, 'error');
        $('#test-result-1').removeClass('pending').addClass('fail')
          .text(`‚ùå –û—à–∏–±–∫–∞: ${error.message}`);
      } finally {
        $btn.prop('disabled', false).text('‚ñ∂Ô∏è –ê–≤—Ç–æ-—Ç–µ—Å—Ç —Å–µ–∫—Ü–∏–∏ 1');
        testRunning = false;
      }
    });

    // ============================================================
    // –ê–í–¢–û-–¢–ï–°–¢ –°–ï–ö–¶–ò–ò 2
    // ============================================================

    $('#btn-auto-test-section-2').on('click', async function () {
      if (testRunning) return;
      testRunning = true;

      const $btn = $(this);
      $btn.prop('disabled', true).text('‚è≥ –¢–µ—Å—Ç –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è...');

      try {
        log('=== –ê–≤—Ç–æ-—Ç–µ—Å—Ç —Å–µ–∫—Ü–∏–∏ 2: –ù–∞—á–∞–ª–æ ===', 'info');
        clearEventTracker('event-tracker-2');

        const comp2 = $('#form-hooks-2').data('modia-component');

        // –®–∞–≥ 1: –í–∫–ª—é—á–∏—Ç—å –æ—Ç–º–µ–Ω—É –≤–∞–ª–∏–¥–∞—Ü–∏–∏
        log('–®–∞–≥ 1: –í–∫–ª—é—á–µ–Ω–∏–µ –æ—Ç–º–µ–Ω—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏...', 'info');
        $('#chk-disable-validation').prop('checked', true).trigger('change');
        await sleep(300);

        const beforeCount2 = hookCounts.beforeValidate;
        const validatedCount2 = hookCounts.validated;

        // –®–∞–≥ 2: –í–∞–ª–∏–¥–∞—Ü–∏—è ‚Üí –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—Ç–º–µ–Ω–µ–Ω–∞
        log('–®–∞–≥ 2: –í–∞–ª–∏–¥–∞—Ü–∏—è (–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—Ç–º–µ–Ω–µ–Ω–∞)...', 'info');
        $('#hook-field-2').val('');
        comp2.clearErrors();
        await sleep(300);

        comp2.validate();
        await sleep(300);

        if (hookCounts.beforeValidate > beforeCount2 && hookCounts.validated === validatedCount2) {
          log('‚úÖ –®–∞–≥ 2: beforeValidate —Å—Ä–∞–±–æ—Ç–∞–ª, validated –ù–ï —Å—Ä–∞–±–æ—Ç–∞–ª (–æ—Ç–º–µ–Ω–∞)', 'success');
        } else {
          throw new Error('–û—Ç–º–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ');
        }

        await sleep(500);

        // –®–∞–≥ 3: –í—ã–∫–ª—é—á–∏—Ç—å –æ—Ç–º–µ–Ω—É ‚Üí –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç
        log('–®–∞–≥ 3: –í—ã–∫–ª—é—á–µ–Ω–∏–µ –æ—Ç–º–µ–Ω—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏...', 'info');
        $('#chk-disable-validation').prop('checked', false).trigger('change');
        await sleep(300);

        const validatedCount3 = hookCounts.validated;
        comp2.validate();
        await sleep(300);

        if (hookCounts.validated > validatedCount3) {
          log('‚úÖ –®–∞–≥ 3: validated —Å—Ä–∞–±–æ—Ç–∞–ª (–≤–∞–ª–∏–¥–∞—Ü–∏—è –≤–∫–ª—é—á–µ–Ω–∞)', 'success');
        } else {
          throw new Error('–í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–∞ –ø–æ—Å–ª–µ –≤–∫–ª—é—á–µ–Ω–∏—è');
        }

        log('=== –ê–≤—Ç–æ-—Ç–µ—Å—Ç —Å–µ–∫—Ü–∏–∏ 2: –£—Å–ø–µ—à–Ω–æ ===', 'success');
        $('#test-result-2').removeClass('pending').addClass('pass')
          .text('‚úÖ –ê–≤—Ç–æ-—Ç–µ—Å—Ç –ø—Ä–æ–π–¥–µ–Ω');

      } catch (error) {
        log(`‚ùå –ê–≤—Ç–æ-—Ç–µ—Å—Ç –ø—Ä–æ–≤–∞–ª–µ–Ω: ${error.message}`, 'error');
        $('#test-result-2').removeClass('pending').addClass('fail')
          .text(`‚ùå –û—à–∏–±–∫–∞: ${error.message}`);
      } finally {
        $btn.prop('disabled', false).text('‚ñ∂Ô∏è –ê–≤—Ç–æ-—Ç–µ—Å—Ç —Å–µ–∫—Ü–∏–∏ 2');
        testRunning = false;
      }
    });

    // ============================================================
    // –ê–í–¢–û-–¢–ï–°–¢ –°–ï–ö–¶–ò–ò 3
    // ============================================================

    $('#btn-auto-test-section-3').on('click', async function () {
      if (testRunning) return;
      testRunning = true;

      const $btn = $(this);
      $btn.prop('disabled', true).text('‚è≥ –¢–µ—Å—Ç –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è...');

      try {
        log('=== –ê–≤—Ç–æ-—Ç–µ—Å—Ç —Å–µ–∫—Ü–∏–∏ 3: –ù–∞—á–∞–ª–æ ===', 'info');
        clearEventTracker('event-tracker-3');

        const comp3 = $('#container-hooks-3').data('modia-component');
        const manualCount1 = hookCounts.manualCheck;

        // –®–∞–≥ 1: –ü—É—Å—Ç–æ–µ –ø–æ–ª–µ ‚Üí manual-check —Å isValid=false
        log('–®–∞–≥ 1: –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—É—Å—Ç–æ–≥–æ –ø–æ–ª—è...', 'info');
        $('#hook-field-3').val('');
        comp3.clearErrors();
        await sleep(300);

        $('[data-validate]', '#container-hooks-3').click();
        await sleep(300);

        if (hookCounts.manualCheck > manualCount1) {
          log('‚úÖ –®–∞–≥ 1: –°–æ–±—ã—Ç–∏–µ manual-check —Å—Ä–∞–±–æ—Ç–∞–ª–æ', 'success');
        } else {
          throw new Error('–°–æ–±—ã—Ç–∏–µ manual-check –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–æ');
        }

        await sleep(500);

        // –®–∞–≥ 2: –ó–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ–µ –ø–æ–ª–µ ‚Üí manual-check —Å isValid=true
        log('–®–∞–≥ 2: –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–ª—è...', 'info');
        $('#hook-field-3').val('–¢–µ—Å—Ç');
        comp3.clearErrors();
        await sleep(300);

        const manualCount2 = hookCounts.manualCheck;
        $('[data-validate]', '#container-hooks-3').click();
        await sleep(300);

        if (hookCounts.manualCheck > manualCount2) {
          log('‚úÖ –®–∞–≥ 2: –°–æ–±—ã—Ç–∏–µ manual-check —Å—Ä–∞–±–æ—Ç–∞–ª–æ (—É—Å–ø–µ—Ö)', 'success');
        } else {
          throw new Error('–°–æ–±—ã—Ç–∏–µ manual-check –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–æ');
        }

        log('=== –ê–≤—Ç–æ-—Ç–µ—Å—Ç —Å–µ–∫—Ü–∏–∏ 3: –£—Å–ø–µ—à–Ω–æ ===', 'success');
        $('#test-result-3').removeClass('pending').addClass('pass')
          .text('‚úÖ –ê–≤—Ç–æ-—Ç–µ—Å—Ç –ø—Ä–æ–π–¥–µ–Ω');

      } catch (error) {
        log(`‚ùå –ê–≤—Ç–æ-—Ç–µ—Å—Ç –ø—Ä–æ–≤–∞–ª–µ–Ω: ${error.message}`, 'error');
        $('#test-result-3').removeClass('pending').addClass('fail')
          .text(`‚ùå –û—à–∏–±–∫–∞: ${error.message}`);
      } finally {
        $btn.prop('disabled', false).text('‚ñ∂Ô∏è –ê–≤—Ç–æ-—Ç–µ—Å—Ç —Å–µ–∫—Ü–∏–∏ 3');
        testRunning = false;
      }
    });

    // ============================================================
    // –ê–í–¢–û-–¢–ï–°–¢ –°–ï–ö–¶–ò–ò 4
    // ============================================================

    $('#btn-auto-test-section-4').on('click', async function () {
      if (testRunning) return;
      testRunning = true;

      const $btn = $(this);
      $btn.prop('disabled', true).text('‚è≥ –¢–µ—Å—Ç –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è...');

      try {
        log('=== –ê–≤—Ç–æ-—Ç–µ—Å—Ç —Å–µ–∫—Ü–∏–∏ 4: –ù–∞—á–∞–ª–æ ===', 'info');
        clearEventTracker('event-tracker-4');

        const comp4 = $('#form-hooks-4').data('modia-component');
        const addedCount1 = hookCounts.fieldAdded;

        // –®–∞–≥ 1: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—è ‚Üí field-added
        log('–®–∞–≥ 1: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—è...', 'info');
        $('#btn-add-field-4').click();
        await sleep(500);

        if (hookCounts.fieldAdded > addedCount1) {
          log('‚úÖ –®–∞–≥ 1: –°–æ–±—ã—Ç–∏–µ field-added —Å—Ä–∞–±–æ—Ç–∞–ª–æ', 'success');
        } else {
          throw new Error('–°–æ–±—ã—Ç–∏–µ field-added –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–æ');
        }

        await sleep(500);

        // –®–∞–≥ 2: –í–∞–ª–∏–¥–∞—Ü–∏—è ‚Üí —É—Å–ø–µ—Ö
        log('–®–∞–≥ 2: –í–∞–ª–∏–¥–∞—Ü–∏—è...', 'info');
        $('input[name="dynamic_field[]"]').first().val('–¢–µ—Å—Ç');
        await sleep(300);

        const isValid = comp4.validate();
        if (isValid) {
          log('‚úÖ –®–∞–≥ 2: –í–∞–ª–∏–¥–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞', 'success');
        } else {
          throw new Error('–í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–µ –ø—Ä–æ—à–ª–∞');
        }

        log('=== –ê–≤—Ç–æ-—Ç–µ—Å—Ç —Å–µ–∫—Ü–∏–∏ 4: –£—Å–ø–µ—à–Ω–æ ===', 'success');
        $('#test-result-4').removeClass('pending').addClass('pass')
          .text('‚úÖ –ê–≤—Ç–æ-—Ç–µ—Å—Ç –ø—Ä–æ–π–¥–µ–Ω');

      } catch (error) {
        log(`‚ùå –ê–≤—Ç–æ-—Ç–µ—Å—Ç –ø—Ä–æ–≤–∞–ª–µ–Ω: ${error.message}`, 'error');
        $('#test-result-4').removeClass('pending').addClass('fail')
          .text(`‚ùå –û—à–∏–±–∫–∞: ${error.message}`);
      } finally {
        $btn.prop('disabled', false).text('‚ñ∂Ô∏è –ê–≤—Ç–æ-—Ç–µ—Å—Ç —Å–µ–∫—Ü–∏–∏ 4');
        testRunning = false;
      }
    });

    // ============================================================
    // –ì–õ–û–ë–ê–õ–¨–ù–´–ô –ê–í–¢–û-–¢–ï–°–¢
    // ============================================================

    $('#btn-auto-test-all').on('click', async function () {
      if (testRunning) return;
      testRunning = true;

      const $btn = $(this);
      $btn.prop('disabled', true).text('‚è≥ –¢–µ—Å—Ç –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è...');

      log('=== –ì–õ–û–ë–ê–õ–¨–ù–´–ô –ê–í–¢–û-–¢–ï–°–¢: –ù–∞—á–∞–ª–æ ===', 'info');

      await $('#btn-auto-test-section-1').click();
      await sleep(1000);
      await $('#btn-auto-test-section-2').click();
      await sleep(1000);
      await $('#btn-auto-test-section-3').click();
      await sleep(1000);
      await $('#btn-auto-test-section-4').click();

      log('=== –ì–õ–û–ë–ê–õ–¨–ù–´–ô –ê–í–¢–û-–¢–ï–°–¢: –ó–∞–≤–µ—Ä—à—ë–Ω ===', 'success');

      $btn.prop('disabled', false).text('‚ñ∂Ô∏è –ó–∞–ø—É—Å—Ç–∏—Ç—å –∞–≤—Ç–æ-—Ç–µ—Å—Ç –≤—Å–µ—Ö —Å–µ–∫—Ü–∏–π');
      testRunning = false;
    });

    // ============================================================
    // –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –õ–û–ì–ê
    // ============================================================

    $('#btn-copy-log').on('click', function (e) {
      e.preventDefault();
      copyLogToClipboard();
    });

    $('#btn-clear-log').on('click', function () {
      $('#console-log').html('<div class="text-muted"><small>[00:00:00] –õ–æ–≥ –æ—á–∏—â–µ–Ω</small></div>');
      log('–õ–æ–≥ –æ—á–∏—â–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º', 'info');
    });

    // ============================================================
    // –ì–õ–û–ë–ê–õ–¨–ù–´–ô –û–ë–†–ê–ë–û–¢–ß–ò–ö –û–®–ò–ë–û–ö
    // ============================================================

    window.addEventListener('error', function (e) {
      log(`‚ùå –ì–ª–æ–±–∞–ª—å–Ω–∞—è –æ—à–∏–±–∫–∞: ${e.message} –≤ ${e.filename}:${e.lineno}`, 'error');
    });

    window.addEventListener('unhandledrejection', function (e) {
      log(`‚ùå –ù–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–∞—è Promise-–æ—à–∏–±–∫–∞: ${e.reason}`, 'error');
    });
  </script>
</body>

</html>