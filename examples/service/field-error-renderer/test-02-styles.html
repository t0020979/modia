<!DOCTYPE html>
<html lang="ru">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Modia ‚Äî –¢–µ—Å—Ç FieldErrorRenderer (–°—Ç–∏–ª–∏)</title>

  <!-- jQuery CDN (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û) -->
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>

  <!-- Bootstrap 4 CDN -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">

  <!-- Modia CSS -->
  <link rel="stylesheet" href="../../../modia/modia.css">

  <!-- –ü—Ä–∏–º–µ—Ä—ã CSS -->
  <link rel="stylesheet" href="../../examples.css">

  <style>
    .style-indicator {
      padding: 5px 10px;
      border-radius: 3px;
      font-weight: bold;
      display: inline-block;
      margin: 5px 0;
    }

    .style-bootstrap {
      background: #d4edda;
      color: #155724;
    }

    .style-rails {
      background: #fff3cd;
      color: #856404;
    }

    .style-custom {
      background: #e7f3ff;
      color: #0056b3;
    }

    .marker-output {
      background: #f8f9fa;
      border: 1px solid #dee2e6;
      padding: 10px;
      font-family: monospace;
      font-size: 12px;
      margin: 10px 0;
      white-space: pre-wrap;
      word-break: break-all;
    }

    /* Rails-—Å—Ç–∏–ª—å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è */
    .field_with_errors {
      border: 2px solid #dc3545;
      padding: 5px;
      border-radius: 3px;
    }
  </style>
</head>

<body>
  <div class="container mt-5">
    <h1>üß™ –¢–µ—Å—Ç FieldErrorRenderer Service</h1>
    <p class="text-muted">–°–º–µ–Ω–∞ —Å—Ç–∏–ª–µ–π: bootstrap / rails / custom</p>

    <!-- –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã -->
    <div class="expected-result">
      <h4>‚úÖ –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:</h4>
      <ul>
        <li>Bootstrap —Å—Ç–∏–ª—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: <code>.is-invalid</code> –Ω–∞ –ø–æ–ª–µ</li>
        <li>Rails —Å—Ç–∏–ª—å: –æ–±—ë—Ä—Ç–∫–∞ <code>.field_with_errors</code></li>
        <li>Custom —Å—Ç–∏–ª—å: –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤</li>
        <li><code>setStyle()</code> –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç —Å—Ç–∏–ª—å –≥–ª–æ–±–∞–ª—å–Ω–æ</li>
        <li><code>renderError(html, styleName)</code> –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ</li>
        <li>–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ: <code>logger.info()</code> –ø—Ä–∏ —Å–º–µ–Ω–µ —Å—Ç–∏–ª—è</li>
      </ul>
    </div>

    <!-- –°–µ–∫—Ü–∏—è 1: Bootstrap (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) -->
    <div class="test-section">
      <h3>üìç –°–µ–∫—Ü–∏—è 1: Bootstrap —Å—Ç–∏–ª—å (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)</h3>

      <div class="form-group" id="form_bootstrap">
        <label for="email_bootstrap">Email *</label>
        <input type="email" id="email_bootstrap" class="form-control" placeholder="test@example.com">
      </div>

      <div class="mt-2">
        <span class="style-indicator style-bootstrap" id="status_bootstrap">–°—Ç–∏–ª—å: bootstrap</span>
      </div>

      <div class="test-buttons">
        <button class="btn btn-primary" id="btn_render_bootstrap">üìù renderError()</button>
        <button class="btn btn-secondary" id="btn_clear_bootstrap">üóëÔ∏è clearError()</button>
        <button class="btn btn-info" id="btn_check_bootstrap">üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–ª–∞—Å—Å—ã</button>
      </div>

      <div class="mt-3">
        <div class="marker-output" id="output_bootstrap">–û–∂–∏–¥–∞–Ω–∏–µ...</div>
      </div>
    </div>

    <!-- –°–µ–∫—Ü–∏—è 2: Rails —Å—Ç–∏–ª—å -->
    <div class="test-section">
      <h3>üìç –°–µ–∫—Ü–∏—è 2: Rails —Å—Ç–∏–ª—å</h3>

      <div class="form-group" id="form_rails">
        <label for="email_rails">Email *</label>
        <input type="email" id="email_rails" class="form-control" placeholder="test@example.com">
      </div>

      <div class="mt-2">
        <span class="style-indicator style-rails" id="status_rails">–°—Ç–∏–ª—å: rails</span>
      </div>

      <div class="test-buttons">
        <button class="btn btn-primary" id="btn_render_rails">üìù renderError()</button>
        <button class="btn btn-secondary" id="btn_clear_rails">üóëÔ∏è clearError()</button>
        <button class="btn btn-info" id="btn_check_rails">üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–±—ë—Ä—Ç–∫—É</button>
      </div>

      <div class="mt-3">
        <div class="marker-output" id="output_rails">–û–∂–∏–¥–∞–Ω–∏–µ...</div>
      </div>
    </div>

    <!-- –°–µ–∫—Ü–∏—è 3: Custom —Å—Ç–∏–ª—å -->
    <div class="test-section">
      <h3>üìç –°–µ–∫—Ü–∏—è 3: Custom —Å—Ç–∏–ª—å (–±–µ–∑ –∫–ª–∞—Å—Å–æ–≤)</h3>

      <div class="form-group" id="form_custom">
        <label for="email_custom">Email *</label>
        <input type="email" id="email_custom" class="form-control" placeholder="test@example.com">
      </div>

      <div class="mt-2">
        <span class="style-indicator style-custom" id="status_custom">–°—Ç–∏–ª—å: custom</span>
      </div>

      <div class="test-buttons">
        <button class="btn btn-primary" id="btn_render_custom">üìù renderError()</button>
        <button class="btn btn-secondary" id="btn_clear_custom">üóëÔ∏è clearError()</button>
        <button class="btn btn-info" id="btn_check_custom">üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–ª–∞—Å—Å—ã</button>
      </div>

      <div class="mt-3">
        <div class="marker-output" id="output_custom">–û–∂–∏–¥–∞–Ω–∏–µ...</div>
      </div>
    </div>

    <!-- –°–µ–∫—Ü–∏—è 4: –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Å–º–µ–Ω–∞ —Å—Ç–∏–ª—è -->
    <div class="test-section">
      <h3>üìç –°–µ–∫—Ü–∏—è 4: setStyle() ‚Äî –≥–ª–æ–±–∞–ª—å–Ω–∞—è —Å–º–µ–Ω–∞</h3>

      <div class="form-group" id="form_global">
        <label for="email_global">Email *</label>
        <input type="email" id="email_global" class="form-control" placeholder="test@example.com">
      </div>

      <div class="mt-2">
        <span class="style-indicator style-bootstrap" id="status_global">–¢–µ–∫—É—â–∏–π —Å—Ç–∏–ª—å: bootstrap</span>
      </div>

      <div class="test-buttons">
        <button class="btn btn-warning" id="btn_set_rails">‚öôÔ∏è setStyle('rails')</button>
        <button class="btn btn-info" id="btn_set_bootstrap">‚öôÔ∏è setStyle('bootstrap')</button>
        <button class="btn btn-secondary" id="btn_set_custom">‚öôÔ∏è setStyle('custom')</button>
      </div>

      <div class="test-buttons">
        <button class="btn btn-primary" id="btn_render_global">üìù renderError()</button>
        <button class="btn btn-secondary" id="btn_clear_render_global">üóëÔ∏è clearError() + renderError()</button>
        <button class="btn btn-info" id="btn_check_global">üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∏–ª—å</button>
        <button class="btn btn-info" id="btn_check_classes">üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–ª–∞—Å—Å—ã –≤ DOM</button>
      </div>

      <div class="mt-3">
        <div class="marker-output" id="output_global">–û–∂–∏–¥–∞–Ω–∏–µ...</div>
        <div class="marker-output" id="output_classes">–û–∂–∏–¥–∞–Ω–∏–µ...</div>
      </div>
    </div>

    <!-- –°–µ–∫—Ü–∏—è 5: –õ–æ–∫–∞–ª—å–Ω–∞—è —Å–º–µ–Ω–∞ —Å—Ç–∏–ª—è -->
    <div class="test-section">
      <h3>üìç –°–µ–∫—Ü–∏—è 5: renderError(html, styleName) ‚Äî –ª–æ–∫–∞–ª—å–Ω–∞—è —Å–º–µ–Ω–∞</h3>

      <div class="form-group" id="form_local">
        <label for="email_local">Email *</label>
        <input type="email" id="email_local" class="form-control" placeholder="test@example.com">
      </div>

      <div class="mt-2">
        <span class="style-indicator style-bootstrap" id="status_local">–°—Ç–∏–ª—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: bootstrap</span>
      </div>

      <div class="test-buttons">
        <button class="btn btn-warning" id="btn_render_local_rails">üìù renderError(..., 'rails')</button>
        <button class="btn btn-primary" id="btn_render_local_bootstrap">üìù renderError(..., 'bootstrap')</button>
        <button class="btn btn-secondary" id="btn_render_local_custom">üìù renderError(..., 'custom')</button>
      </div>

      <div class="test-buttons">
        <button class="btn btn-info" id="btn_check_local">üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫</button>
      </div>

      <div class="mt-3">
        <div class="marker-output" id="output_local">–û–∂–∏–¥–∞–Ω–∏–µ...</div>
      </div>
    </div>

    <!-- –ö–æ–Ω—Å–æ–ª—å –ª–æ–≥ -->
    <div class="test-section">
      <h3>üìã –ö–æ–Ω—Å–æ–ª—å –ª–æ–≥</h3>
      <div class="event-log" id="console-log" style="max-height: 300px;"></div>
      <div class="test-buttons">
        <button class="btn btn-secondary" id="btn_clear_log">üßπ –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥</button>
      </div>
    </div>

    <hr>

    <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Ç–µ—Å—Ç–∞–º -->
    <div class="test-buttons">
      <a href="test-01-basic-render.html" class="btn btn-outline-secondary">‚Üê –ü—Ä–µ–¥—ã–¥—É—â–∏–π —Ç–µ—Å—Ç</a>
      <a href="test-03-legacy-templates.html" class="btn btn-outline-primary">–°–ª–µ–¥—É—é—â–∏–π —Ç–µ—Å—Ç: Legacy ‚Üí</a>
    </div>
  </div>

  <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –º–æ–¥—É–ª—è (–æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø—É—Ç—å!) -->
  <script type="module">
    import { FieldErrorRenderer } from '../../../modia/services/field-error-renderer.js';
    import { logger } from '../../../modia/services/logger.js';

    // ========================================
    // –£—Ç–∏–ª–∏—Ç–∞ –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
    // ========================================
    function logToPage(message, type = 'info') {
      const $log = $('#console-log');
      const timestamp = new Date().toLocaleTimeString('ru-RU');
      const color = type === 'error' ? 'text-danger'
        : type === 'success' ? 'text-success'
          : 'text-muted';
      $log.append(`<div class="${color}"><small>[${timestamp}] ${message}</small></div>`);
      $log.scrollTop($log[0].scrollHeight);
      console.log(`[FieldErrorRenderer Test] ${message}`);
    }

    // –ü–µ—Ä–µ—Ö–≤–∞—Ç logger.info/warn/error –¥–ª—è –≤—ã–≤–æ–¥–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É
    const originalInfo = logger.info;
    const originalWarn = logger.warn;
    const originalError = logger.error;

    logger.info = function (message, context) {
      logToPage(`[INFO] [${context || 'Test'}] ${message}`, 'info');
      originalInfo.call(logger, message, context);
    };

    logger.warn = function (message, context) {
      logToPage(`[WARN] [${context || 'Test'}] ${message}`, 'error');
      originalWarn.call(logger, message, context);
    };

    logger.error = function (message, context) {
      logToPage(`[ERROR] [${context || 'Test'}] ${message}`, 'error');
      originalError.call(logger, message, context);
    };

    // ========================================
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–Ω–¥–µ—Ä–µ—Ä–æ–≤
    // ========================================
    const rendererBootstrap = new FieldErrorRenderer($('#email_bootstrap'));
    const rendererRails = new FieldErrorRenderer($('#email_rails'));
    const rendererCustom = new FieldErrorRenderer($('#email_custom'));
    const rendererGlobal = new FieldErrorRenderer($('#email_global'));
    const rendererLocal = new FieldErrorRenderer($('#email_local'));

    logToPage('FieldErrorRenderer –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã', 'success');

    // ========================================
    // –°–µ–∫—Ü–∏—è 1: Bootstrap (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
    // ========================================
    $('#btn_render_bootstrap').on('click', function () {
      rendererBootstrap.renderError('<span class="text-danger">–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π email –∞–¥—Ä–µ—Å</span>');
    });

    $('#btn_clear_bootstrap').on('click', function () {
      rendererBootstrap.clearError();
    });

    $('#btn_check_bootstrap').on('click', function () {
      const hasClass = $('#email_bootstrap').hasClass('is-invalid');
      const parentClass = $('#email_bootstrap').parent().attr('class');

      const output = {
        'hasClass("is-invalid")': hasClass,
        'parent.class': parentClass,
        'siblings': $('#email_bootstrap').siblings('[data-modia-error]').length
      };

      $('#output_bootstrap').text(JSON.stringify(output, null, 2));
      logToPage(`Bootstrap –∫–ª–∞—Å—Å—ã –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã`, 'success');
    });

    // ========================================
    // –°–µ–∫—Ü–∏—è 2: Rails —Å—Ç–∏–ª—å
    // ========================================
    $('#btn_render_rails').on('click', function () {
      rendererRails.renderError('<span class="form-error-message">–û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏</span>', 'rails');
    });

    $('#btn_clear_rails').on('click', function () {
      rendererRails.clearError();
    });

    $('#btn_check_rails').on('click', function () {
      const $parent = $('#email_rails').parent();
      const hasWrapper = $parent.hasClass('field_with_errors');

      const output = {
        'hasWrapper("field_with_errors")': hasWrapper,
        'parent.tagName': $parent[0].tagName,
        'parent.class': $parent.attr('class'),
        'siblings': $('#email_rails').siblings('[data-modia-error]').length
      };

      $('#output_rails').text(JSON.stringify(output, null, 2));
      logToPage(`Rails –æ–±—ë—Ä—Ç–∫–∞ –ø—Ä–æ–≤–µ—Ä–µ–Ω–∞`, 'success');
    });

    // ========================================
    // –°–µ–∫—Ü–∏—è 3: Custom —Å—Ç–∏–ª—å
    // ========================================
    $('#btn_render_custom').on('click', function () {
      rendererCustom.renderError('<span>Custom –æ—à–∏–±–∫–∞</span>', 'custom');
    });

    $('#btn_clear_custom').on('click', function () {
      rendererCustom.clearError();
    });

    $('#btn_check_custom').on('click', function () {
      const hasClass = $('#email_custom').hasClass('is-invalid') ||
        $('#email_custom').hasClass('form-error');

      const output = {
        'hasErrorClass': hasClass,
        'classes': $('#email_custom').attr('class'),
        'siblings': $('#email_custom').siblings('[data-modia-error]').length
      };

      $('#output_custom').text(JSON.stringify(output, null, 2));
      logToPage(`Custom –∫–ª–∞—Å—Å—ã –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã (–¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø—É—Å—Ç—ã–º–∏)`, 'success');
    });

    // ========================================
    // –°–µ–∫—Ü–∏—è 4: –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Å–º–µ–Ω–∞ —Å—Ç–∏–ª—è (–ò–°–ü–†–ê–í–õ–ï–ù–û)
    // ========================================

    $('#btn_set_rails').on('click', function () {
      rendererGlobal.setStyle('rails');
      $('#status_global').text('–¢–µ–∫—É—â–∏–π —Å—Ç–∏–ª—å: rails')
        .removeClass('style-bootstrap style-custom')
        .addClass('style-rails');
      logToPage('–°—Ç–∏–ª—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω: rails', 'info');
    });

    $('#btn_set_bootstrap').on('click', function () {
      rendererGlobal.setStyle('bootstrap');
      $('#status_global').text('–¢–µ–∫—É—â–∏–π —Å—Ç–∏–ª—å: bootstrap')
        .removeClass('style-rails style-custom')
        .addClass('style-bootstrap');
      logToPage('–°—Ç–∏–ª—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω: bootstrap', 'info');
    });

    $('#btn_set_custom').on('click', function () {
      rendererGlobal.setStyle('custom');
      $('#status_global').text('–¢–µ–∫—É—â–∏–π —Å—Ç–∏–ª—å: custom')
        .removeClass('style-bootstrap style-rails')
        .addClass('style-custom');
      logToPage('–°—Ç–∏–ª—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω: custom', 'info');
    });

    $('#btn_render_global').on('click', function () {
      // ‚úÖ –û—á–∏—â–∞–µ–º –ø–µ—Ä–µ–¥ —Ä–µ–Ω–¥–µ—Ä–æ–º (–∫–∞–∫ –≤ Test 5)
      rendererGlobal.clearError();
      rendererGlobal.renderError('<span>–û—à–∏–±–∫–∞ —Å –≥–ª–æ–±–∞–ª—å–Ω—ã–º —Å—Ç–∏–ª–µ–º</span>');
      logToPage('–û—à–∏–±–∫–∞ –æ—Ç—Ä–µ–Ω–¥–µ—Ä–µ–Ω–∞ —Å —Ç–µ–∫—É—â–∏–º —Å—Ç–∏–ª–µ–º', 'info');
    });

    $('#btn_clear_render_global').on('click', function () {
      // ‚úÖ –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ + —Ä–µ–Ω–¥–µ—Ä
      rendererGlobal.clearError();
      rendererGlobal.renderError('<span>–û—à–∏–±–∫–∞ –ø–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏</span>');
      logToPage('–û—á–∏—Å—Ç–∫–∞ + —Ä–µ–Ω–¥–µ—Ä', 'success');
    });

    $('#btn_check_global').on('click', function () {
      const $field = $('#email_global');
      const $parent = $field.parent();
      const errorCount = $('[data-modia-error^="form_global:"]').length;

      const output = {
        'currentStyle.errorClass': rendererGlobal.currentStyle.errorClass,
        'currentStyle.containerClass': rendererGlobal.currentStyle.containerClass,
        'currentStyle.messageClass': rendererGlobal.currentStyle.messageClass,
        'field.hasClass(errorClass)': rendererGlobal.currentStyle.errorClass ?
          $field.hasClass(rendererGlobal.currentStyle.errorClass) : 'N/A (–ø—É—Å—Ç–æ–π –∫–ª–∞—Å—Å)',
        'parent.hasClass(containerClass)': rendererGlobal.currentStyle.containerClass ?
          $parent.hasClass(rendererGlobal.currentStyle.containerClass) : 'N/A (–ø—É—Å—Ç–æ–π –∫–ª–∞—Å—Å)',
        'parent.tagName': $parent[0].tagName,
        'errorCount': errorCount,
        'idempotency': errorCount === 1 ? '‚úÖ OK' : '‚ùå FAIL'
      };

      $('#output_global').text(JSON.stringify(output, null, 2));
      logToPage(`–°—Ç–∏–ª—å –ø—Ä–æ–≤–µ—Ä–µ–Ω: errorClass="${rendererGlobal.currentStyle.errorClass}"`, 'success');
    });



    $('#btn_check_classes').on('click', function () {
        const $field = $('#email_global');
        const $parent = $field.parent();
        const $error = $('[data-modia-error^="form_global:"]').first();

        const output = {
          'currentStyle': rendererGlobal.currentStyle,
          'field.classes': $field.attr('class'),
          'parent.tagName': $parent[0].tagName,
          'parent.classes': $parent.attr('class'),
          'parent.hasClass(field_with_errors)': $parent.hasClass('field_with_errors'),
          'error.messageClass': $error.attr('class'),
          'idempotency': $('[data-modia-error^="form_global:"]').length === 1 ? '‚úÖ OK' : '‚ùå FAIL'
        };

        $('#output_classes').text(JSON.stringify(output, null, 2));
        logToPage('–ö–ª–∞—Å—Å—ã –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã –≤ DOM', 'success');
    });
    // ========================================
    // –°–µ–∫—Ü–∏—è 5: –õ–æ–∫–∞–ª—å–Ω–∞—è —Å–º–µ–Ω–∞ —Å—Ç–∏–ª—è
    // ========================================
    $('#btn_render_local_rails').on('click', function () {
      // ‚úÖ –û—á–∏—â–∞–µ–º –ø–µ—Ä–µ–¥ —Ä–µ–Ω–¥–µ—Ä–æ–º —Å –Ω–æ–≤—ã–º —Å—Ç–∏–ª–µ–º
      rendererLocal.clearError();
      rendererLocal.renderError('<span>Rails –æ—à–∏–±–∫–∞</span>', 'rails');
      $('#status_local').text('–ü–æ—Å–ª–µ–¥–Ω–∏–π —Ä–µ–Ω–¥–µ—Ä: rails')
        .removeClass('style-bootstrap style-custom')
        .addClass('style-rails');
      logToPage('–õ–æ–∫–∞–ª—å–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä: rails', 'info');
    });

    $('#btn_render_local_bootstrap').on('click', function () {
      rendererLocal.clearError();
      rendererLocal.renderError('<span>Bootstrap –æ—à–∏–±–∫–∞</span>', 'bootstrap');
      $('#status_local').text('–ü–æ—Å–ª–µ–¥–Ω–∏–π —Ä–µ–Ω–¥–µ—Ä: bootstrap')
        .removeClass('style-rails style-custom')
        .addClass('style-bootstrap');
      logToPage('–õ–æ–∫–∞–ª—å–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä: bootstrap', 'info');
    });

    $('#btn_render_local_custom').on('click', function () {
      rendererLocal.clearError();
      rendererLocal.renderError('<span>Custom –æ—à–∏–±–∫–∞</span>', 'custom');
      $('#status_local').text('–ü–æ—Å–ª–µ–¥–Ω–∏–π —Ä–µ–Ω–¥–µ—Ä: custom')
        .removeClass('style-bootstrap style-rails')
        .addClass('style-custom');
      logToPage('–õ–æ–∫–∞–ª—å–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä: custom', 'info');
    });

    $('#btn_check_local').on('click', function () {
      const errorCount = $('[data-modia-error^="form_local:"]').length;

      const output = {
        'defaultStyle': rendererLocal.config.defaultStyle,
        'currentStyle': rendererLocal.currentStyle,
        'errorCount': errorCount,
        'idempotency': errorCount === 1 ? '‚úÖ OK (–ø—Ä–µ–¥—ã–¥—É—â–∞—è –æ—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∞)' : '‚ùå FAIL'
      };

      $('#output_local').text(JSON.stringify(output, null, 2));
      logToPage(`–õ–æ–∫–∞–ª—å–Ω—ã–π —Å—Ç–∏–ª—å –ø—Ä–æ–≤–µ—Ä–µ–Ω (–æ—à–∏–±–æ–∫: ${errorCount})`, errorCount === 1 ? 'success' : 'error');
    });

    // ========================================
    // –£—Ç–∏–ª–∏—Ç—ã
    // ========================================
    $('#btn_clear_log').on('click', function () {
      $('#console-log').empty();
      logToPage('–õ–æ–≥ –æ—á–∏—â–µ–Ω', 'info');
    });

    // –ù–∞—á–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
    logToPage('–¢–µ—Å—Ç –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ', 'success');
    logToPage('–û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ª–æ–≥–æ–≤ logger', 'info');
  </script>
</body>

</html>