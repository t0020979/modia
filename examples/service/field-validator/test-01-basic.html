<!DOCTYPE html>
<html lang="ru">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Modia ‚Äî –¢–µ—Å—Ç FieldValidator (–ë–∞–∑–æ–≤—ã–π)</title>

  <!-- ‚úÖ jQuery CDN (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û) -->
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>

  <!-- Bootstrap 4 CDN -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">

  <!-- ‚úÖ Modia CSS (–æ—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç–∏–ª–∏ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞) -->
  <link rel="stylesheet" href="../../../modia/modia.css">

  <!-- –ü—Ä–∏–º–µ—Ä—ã CSS (–æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø—É—Ç—å!) -->
  <link rel="stylesheet" href="../../../examples/examples.css">

  <style>
    .test-section {
      border: 1px solid #dee2e6;
      border-radius: 4px;
      padding: 20px;
      margin-bottom: 20px;
      background: #f8f9fa;
    }

    .instruction-box {
      background: #e7f3ff;
      border-left: 4px solid #007bff;
      padding: 10px;
      margin: 10px 0;
      font-size: 13px;
    }

    .console-log {
      background: #1e1e1e;
      color: #d4d4d4;
      padding: 15px;
      border-radius: 4px;
      height: 200px;
      overflow-y: auto;
      font-family: 'Courier New', monospace;
      font-size: 12px;
      margin-top: 20px;
    }

    .test-result {
      padding: 10px;
      border-radius: 4px;
      margin-top: 10px;
    }

    .test-result.pass {
      background: #d4edda;
      color: #155724;
    }

    .test-result.fail {
      background: #f8d7da;
      color: #721c24;
    }

    .test-result.pending {
      background: #fff3cd;
      color: #856404;
    }

    .auto-test-running {
      animation: pulse 1s infinite;
    }

    @keyframes pulse {
      0% {
        opacity: 1;
      }

      50% {
        opacity: 0.6;
      }

      100% {
        opacity: 1;
      }
    }
  </style>
</head>

<body>
  <div class="container mt-5">
    <h1>üß™ –¢–µ—Å—Ç FieldValidator Service</h1>
    <p class="lead">–ë–∞–∑–æ–≤–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è + –æ—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã</p>

    <!-- –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã -->
    <div class="expected-result alert alert-info">
      <h4>‚úÖ –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:</h4>
      <ul>
        <li><code>validate()</code> –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç <code>true/false</code> –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ</li>
        <li><code>getFieldValue()</code> –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ–ª—è (string –¥–ª—è –æ–¥–∏–Ω–æ—á–Ω–æ–≥–æ, Array –¥–ª—è –≥—Ä—É–ø–ø—ã)</li>
        <li><code>isVisibleForValidation()</code> –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤–∏–¥–∏–º–æ—Å—Ç—å —ç–∫—Ä–∞–Ω–∞ –æ—à–∏–±–∫–∏</li>
        <li><code>loadRules()</code> –∫—ç—à–∏—Ä—É–µ—Ç –ø—Ä–∞–≤–∏–ª–∞ –≤ <code>applicableRules</code></li>
        <li><code>clearError()</code> –æ—á–∏—â–∞–µ—Ç –æ—à–∏–±–∫—É —á–µ—Ä–µ–∑ —Ä–µ–Ω–¥–µ—Ä–µ—Ä</li>
        <li>–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ <code>logger</code> (info/warn/error)</li>
        <li>–°–µ—Ä–≤–∏—Å –ù–ï –∑–∞–≤–∏—Å–∏—Ç –æ—Ç <code>validationRules.js</code> (–ø—Ä–∞–≤–∏–ª–∞ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –∏–∑–≤–Ω–µ)</li>
      </ul>
    </div>

    <!-- –°–µ–∫—Ü–∏—è 1: –ë–∞–∑–æ–≤–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è -->
    <div class="test-section" id="section_1">
      <h3>üìç –°–µ–∫—Ü–∏—è 1: –ë–∞–∑–æ–≤–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è</h3>

      <div class="instruction-box">
        <strong>üìã –†—É—á–Ω–æ–π —Ç–µ—Å—Ç:</strong><br>
        1. –ù–∞–∂–º–∏—Ç–µ <code>üìù –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å</code> ‚Üí –¥–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å <code>false</code> (–ø–æ–ª–µ –ø—É—Å—Ç–æ–µ)<br>
        2. –í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –≤ –ø–æ–ª–µ<br>
        3. –ù–∞–∂–º–∏—Ç–µ <code>üìù –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å</code> ‚Üí –¥–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å <code>true</code><br>
        4. –ù–∞–∂–º–∏—Ç–µ <code>üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –æ—à–∏–±–∫—É</code> ‚Üí –æ—à–∏–±–∫–∞ –¥–æ–ª–∂–Ω–∞ –∏—Å—á–µ–∑–Ω—É—Ç—å
      </div>

      <!-- ‚ö†Ô∏è –ù–ï–¢ data-component="validation" ‚Äî —Ç–µ—Å—Ç–∏—Ä—É–µ–º —Å–µ—Ä–≤–∏—Å, –Ω–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç -->
      <form id="form-basic" >
        <div class="form-group">
          <label>Email *</label>
          <input type="text" id="email" name="email" required class="form-control" placeholder="–í–≤–µ–¥–∏—Ç–µ email">
        </div>

        <div class="error-templates">
          <span class="text-danger" data-rule="required">–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ</span>
        </div>
      </form>

      <div class="test-buttons mt-3">
        <button type="submit" id="btn_validate" class="btn btn-primary">üìù –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å</button>
        <button id="btn_clear" class="btn btn-secondary">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –æ—à–∏–±–∫—É</button>
        <button id="btn_check_value" class="btn btn-info">üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ</button>
      </div>

      <div id="result_1" class="test-result pending">–û–∂–∏–¥–∞–Ω–∏–µ...</div>
    </div>

    <!-- –°–µ–∫—Ü–∏—è 2: isVisibleForValidation() -->
    <div class="test-section" id="section_2">
      <h3>üìç –°–µ–∫—Ü–∏—è 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∏–¥–∏–º–æ—Å—Ç–∏</h3>

      <div class="instruction-box">
        <strong>üìã –†—É—á–Ω–æ–π —Ç–µ—Å—Ç:</strong><br>
        1. –ù–∞–∂–º–∏—Ç–µ <code>üëÅÔ∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç—å</code> ‚Üí –¥–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å <code>true</code><br>
        2. –ù–∞–∂–º–∏—Ç–µ <code>üôà –°–∫—Ä—ã—Ç—å –ø–æ–ª–µ</code><br>
        3. –ù–∞–∂–º–∏—Ç–µ <code>üëÅÔ∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç—å</code> ‚Üí –¥–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å <code>false</code><br>
        4. –ù–∞–∂–º–∏—Ç–µ <code>üôâ –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª–µ</code>
      </div>

      <form id="form-visibility" >
        <div class="form-group">
          <label>–¢–µ–ª–µ—Ñ–æ–Ω *</label>
          <input type="text" id="phone" name="phone" required class="form-control">
        </div>

        <div class="error-templates">
          <span class="text-danger" data-rule="required">–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ</span>
        </div>
      </form>

      <div class="test-buttons mt-3">
        <button id="btn_check_visible" class="btn btn-primary">üëÅÔ∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç—å</button>
        <button id="btn_hide" class="btn btn-warning">üôà –°–∫—Ä—ã—Ç—å –ø–æ–ª–µ</button>
        <button id="btn_show" class="btn btn-success">üôâ –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª–µ</button>
      </div>

      <div id="result_2" class="test-result pending">–û–∂–∏–¥–∞–Ω–∏–µ...</div>
    </div>

    <!-- –°–µ–∫—Ü–∏—è 3: loadRules() -->
    <div class="test-section" id="section_3">
      <h3>üìç –°–µ–∫—Ü–∏—è 3: –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∞–≤–∏–ª</h3>

      <div class="instruction-box">
        <strong>üìã –†—É—á–Ω–æ–π —Ç–µ—Å—Ç:</strong><br>
        1. –ù–∞–∂–º–∏—Ç–µ <code>üì¶ –ó–∞–≥—Ä—É–∑–∏—Ç—å –ø—Ä–∞–≤–∏–ª–∞</code> ‚Üí –ø–æ–∫–∞–∂–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∞–≤–∏–ª<br>
        2. –ù–∞–∂–º–∏—Ç–µ <code>üîÑ –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª–∞</code> ‚Üí –æ–±–Ω–æ–≤–∏—Ç –∫—ç—à –ø—Ä–∞–≤–∏–ª
      </div>

      <form id="form-rules" >
        <div class="form-group">
          <label>–ò–º—è *</label>
          <input type="text" id="name" name="name" required class="form-control">
        </div>

        <div class="error-templates">
          <span class="text-danger" data-rule="required">–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ</span>
        </div>
      </form>

      <div class="test-buttons mt-3">
        <button type="submit" id="btn_load_rules" class="btn btn-primary">üì¶ –ó–∞–≥—Ä—É–∑–∏—Ç—å –ø—Ä–∞–≤–∏–ª–∞</button>
        <button id="btn_refresh_rules" class="btn btn-info">üîÑ –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª–∞</button>
      </div>

      <div id="result_3" class="test-result pending">–û–∂–∏–¥–∞–Ω–∏–µ...</div>
    </div>

    <!-- –ö–Ω–æ–ø–∫–∏ –∞–≤—Ç–æ-—Ç–µ—Å—Ç–∞ -->
    <div class="test-buttons mt-4">
      <button id="btn_auto_test_all" class="btn btn-success btn-lg">‚ñ∂Ô∏è –ó–∞–ø—É—Å—Ç–∏—Ç—å –∞–≤—Ç–æ-—Ç–µ—Å—Ç –≤—Å–µ—Ö —Å–µ–∫—Ü–∏–π</button>
      <button id="btn_stop_test" class="btn btn-danger btn-lg">‚èπÔ∏è –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</button>
    </div>

    <div id="auto_test_status" class="alert alert-info mt-3" style="display: none;">
      –°—Ç–∞—Ç—É—Å: <span id="auto_test_status_text">–û–∂–∏–¥–∞–Ω–∏–µ...</span>
    </div>

    <!-- –ö–æ–Ω—Å–æ–ª—å –ª–æ–≥ -->
    <div class="console-log" id="console-log">
      <div class="text-muted"><small>[00:00:00] –ö–æ–Ω—Å–æ–ª—å –ª–æ–≥–≥–µ—Ä–∞ –≥–æ—Ç–æ–≤–∞...</small></div>
    </div>

    <div class="test-buttons mt-2">
      <button id="btn_clear_log" class="btn btn-sm btn-secondary">üßπ –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥</button>
    </div>

    <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
    <div class="mt-4">
      <a href="../field-error-renderer/test-01-basic-render.html" class="btn btn-outline-secondary">[‚Üê –ü—Ä–µ–¥—ã–¥—É—â–∏–π —Ç–µ—Å—Ç:
        FieldErrorRenderer]</a>
      <a href="test-02-message-hierarchy.html" class="btn btn-outline-primary ml-2">[–°–ª–µ–¥—É—é—â–∏–π —Ç–µ—Å—Ç: –ò–µ—Ä–∞—Ä—Ö–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π
        ‚Üí]</a>
    </div>
  </div>

  <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –º–æ–¥—É–ª—è (–æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø—É—Ç—å!) -->
  <script type="module">
    import { FieldValidator } from '../../../modia/services/field-validator.js';
    import { FieldErrorRenderer } from '../../../modia/services/field-error-renderer.js';
    import { logger } from '../../../modia/services/logger.js';

    // ========================================================================
    // Mock Rules ‚Äî —Å–µ—Ä–≤–∏—Å –ù–ï –∑–∞–≤–∏—Å–∏—Ç –æ—Ç validationRules.js
    // –ü—Ä–∞–≤–∏–ª–∞ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –∫–∞–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å ValidationRule
    // ========================================================================
    const mockValidationRules = [
      {
        name: 'required',
        selector: '[required]',
        defaultMessage: '–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ',
        validate($field, validator) {
          const value = validator.getFieldValue();
          const values = Array.isArray(value) ? value : [value];
          const hasFilledValue = values.some(val => val !== null && val !== undefined && val.trim() !== '');
          return hasFilledValue ? true : { valid: false, params: {} };
        }
      },
      {
        name: 'max-length',
        selector: '[data-max-length]',
        defaultMessage: '–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞: __count__ —Å–∏–º–≤–æ–ª–æ–≤',
        validate($field, validator) {
          const maxLength = parseInt($field.data('max-length'), 10);
          const value = validator.getFieldValue();
          const values = Array.isArray(value) ? value : [value];
          const allValid = values.every(val => val.length <= maxLength);
          return allValid ? true : { valid: false, params: { count: maxLength } };
        }
      }
    ];

    // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Ç–µ—Å—Ç–æ–≤
    let validator1, validator2, validator3;
    let renderer1, renderer2, renderer3;
    let autoTestRunning = false;

    // ========================================================================
    // –§—É–Ω–∫—Ü–∏—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (–¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–Ω—Å–æ–ª—å + HTML)
    // ========================================================================
    function log(message, type = 'info') {
      const $log = $('#console-log');
      const timestamp = new Date().toLocaleTimeString('ru-RU');
      const color = type === 'error' ? 'text-danger'
        : type === 'success' ? 'text-success'
          : 'text-muted';
      $log.append(`<div class="${color}"><small>[${timestamp}] ${message}</small></div>`);
      $log.scrollTop($log[0].scrollHeight);
      console.log(`[FieldValidator Test] ${message}`);
    }

    // ========================================================================
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤–∞–ª–∏–¥–∞—Ç–æ—Ä–æ–≤
    // ========================================================================
    function initValidators() {
      // –í–∞–ª–∏–¥–∞—Ç–æ—Ä 1: –ë–∞–∑–æ–≤–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
      const $email = $('#email');
      renderer1 = new FieldErrorRenderer($email);
      validator1 = new FieldValidator($email, $email, $('#form-basic'), mockValidationRules, renderer1);

      // –í–∞–ª–∏–¥–∞—Ç–æ—Ä 2: –í–∏–¥–∏–º–æ—Å—Ç—å
      const $phone = $('#phone');
      renderer2 = new FieldErrorRenderer($phone);
      validator2 = new FieldValidator($phone, $phone, $('#form-visibility'), mockValidationRules, renderer2);

      // –í–∞–ª–∏–¥–∞—Ç–æ—Ä 3: –ü—Ä–∞–≤–∏–ª–∞
      const $name = $('#name');
      renderer3 = new FieldErrorRenderer($name);
      validator3 = new FieldValidator($name, $name, $('#form-rules'), mockValidationRules, renderer3);

      log('–í–∞–ª–∏–¥–∞—Ç–æ—Ä—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã', 'success');
    }

    // ========================================================================
    // –°–µ–∫—Ü–∏—è 1: –ë–∞–∑–æ–≤–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
    // ========================================================================
    $('#btn_validate').on('click', function () {
      const isValid = validator1.validate();
      const value = validator1.getFieldValue();

      $('#result_1')
        .removeClass('pending pass fail')
        .addClass(isValid ? 'pass' : 'fail')
        .text(`validate(): ${isValid} | getFieldValue(): "${value}"`);

      log(`validate(): ${isValid}, value: "${value}"`, isValid ? 'success' : 'error');
    });

    $('#btn_clear').on('click', function () {
      validator1.clearError();
      $('#result_1').addClass('pass').text('–û—à–∏–±–∫–∞ –æ—á–∏—â–µ–Ω–∞');
      log('clearError() –≤—ã–∑–≤–∞–Ω', 'info');
    });

    $('#btn_check_value').on('click', function () {
      const value = validator1.getFieldValue();
      const isArray = Array.isArray(value);
      $('#result_1').addClass('pass').text(`getFieldValue(): "${value}" (type: ${isArray ? 'Array' : 'string'})`);
      log(`getFieldValue(): "${value}" (${isArray ? 'Array' : 'string'})`, 'info');
    });

    // ========================================================================
    // –°–µ–∫—Ü–∏—è 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∏–¥–∏–º–æ—Å—Ç–∏
    // ========================================================================
    $('#btn_check_visible').on('click', function () {
      const isVisible = validator2.isVisibleForValidation();
      $('#result_2')
        .removeClass('pending pass fail')
        .addClass(isVisible ? 'pass' : 'fail')
        .text(`isVisibleForValidation(): ${isVisible}`);
      log(`isVisibleForValidation(): ${isVisible}`, isVisible ? 'success' : 'warn');
    });

    $('#btn_hide').on('click', function () {
      $('#phone').closest('.form-group').hide();
      $('#result_2').addClass('pending').text('–ü–æ–ª–µ —Å–∫—Ä—ã—Ç–æ');
      log('–ü–æ–ª–µ —Å–∫—Ä—ã—Ç–æ (display: none)', 'info');
    });

    $('#btn_show').on('click', function () {
      $('#phone').closest('.form-group').show();
      $('#result_2').addClass('pending').text('–ü–æ–ª–µ –ø–æ–∫–∞–∑–∞–Ω–æ');
      log('–ü–æ–ª–µ –ø–æ–∫–∞–∑–∞–Ω–æ', 'info');
    });

    // ========================================================================
    // –°–µ–∫—Ü–∏—è 3: –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∞–≤–∏–ª
    // ========================================================================
    $('#btn_load_rules').on('click', function () {
      const ruleCount = validator3.applicableRules ? validator3.applicableRules.length : 0;
      $('#result_3').addClass('pass').text(`–ó–∞–≥—Ä—É–∂–µ–Ω–æ –ø—Ä–∞–≤–∏–ª: ${ruleCount}`);
      log(`loadRules(): –∑–∞–≥—Ä—É–∂–µ–Ω–æ ${ruleCount} –ø—Ä–∞–≤–∏–ª`, 'success');
    });

    $('#btn_refresh_rules').on('click', function () {
      validator3.loadRules();
      const ruleCount = validator3.applicableRules ? validator3.applicableRules.length : 0;
      $('#result_3').addClass('pass').text(`–ü—Ä–∞–≤–∏–ª–∞ –æ–±–Ω–æ–≤–ª–µ–Ω—ã: ${ruleCount}`);
      log(`loadRules() –æ–±–Ω–æ–≤–ª–µ–Ω–æ: ${ruleCount} –ø—Ä–∞–≤–∏–ª`, 'info');
    });

    // ========================================================================
    // –ê–≤—Ç–æ-—Ç–µ—Å—Ç –≤—Å–µ—Ö —Å–µ–∫—Ü–∏–π
    // ========================================================================
    async function sleep(ms) {
      return new Promise(resolve => setTimeout(resolve, ms));
    }

    async function runAutoTestAll() {
      if (autoTestRunning) return;
      autoTestRunning = true;

      $('#auto_test_status').show();
      $('#auto_test_status_text').text('–ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤...');

      log('=== –ó–ê–ü–£–°–ö –ê–í–¢–û-–¢–ï–°–¢–ê ===', 'info');

      // –°–µ–∫—Ü–∏—è 1
      $('#auto_test_status_text').text('–°–µ–∫—Ü–∏—è 1: –ë–∞–∑–æ–≤–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è...');
      $('#section_1').addClass('auto-test-running');
      await sleep(500);
      $('#btn_validate').click();
      await sleep(800);
      $('#btn_clear').click();
      await sleep(500);
      $('#section_1').removeClass('auto-test-running');

      // –°–µ–∫—Ü–∏—è 2
      $('#auto_test_status_text').text('–°–µ–∫—Ü–∏—è 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∏–¥–∏–º–æ—Å—Ç–∏...');
      $('#section_2').addClass('auto-test-running');
      await sleep(500);
      $('#btn_check_visible').click();
      await sleep(800);
      $('#btn_hide').click();
      await sleep(500);
      $('#btn_check_visible').click();
      await sleep(800);
      $('#btn_show').click();
      await sleep(500);
      $('#section_2').removeClass('auto-test-running');

      // –°–µ–∫—Ü–∏—è 3
      $('#auto_test_status_text').text('–°–µ–∫—Ü–∏—è 3: –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∞–≤–∏–ª...');
      $('#section_3').addClass('auto-test-running');
      await sleep(500);
      $('#btn_load_rules').click();
      await sleep(800);
      $('#btn_refresh_rules').click();
      await sleep(500);
      $('#section_3').removeClass('auto-test-running');

      $('#auto_test_status_text').text('‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –∑–∞–≤–µ—Ä—à–µ–Ω—ã!');
      $('#auto_test_status').addClass('alert-success');
      log('=== –ê–í–¢–û-–¢–ï–°–¢ –ó–ê–í–ï–†–®–Å–ù ===', 'success');

      autoTestRunning = false;
    }

    $('#btn_auto_test_all').on('click', runAutoTestAll);

    $('#btn_stop_test').on('click', function () {
      autoTestRunning = false;
      $('#auto_test_status').hide();
      $('.auto-test-running').removeClass('auto-test-running');
      log('–ê–≤—Ç–æ—Ç–µ—Å—Ç –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º', 'warn');
    });

    $('#btn_clear_log').on('click', function () {
      $('#console-log').html('<div class="text-muted"><small>[00:00:00] –õ–æ–≥ –æ—á–∏—â–µ–Ω...</small></div>');
      log('–õ–æ–≥ –æ—á–∏—â–µ–Ω', 'info');
    });

    // ========================================================================
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
    // ========================================================================
    $(document).ready(function () {
      initValidators();
      log('–¢–µ—Å—Ç FieldValidator –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ', 'success');
    });
  </script>
</body>

</html>