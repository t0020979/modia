<!DOCTYPE html>
<html lang="ru">

<head>
  <meta charset="UTF-8">
  <title>Modia ‚Äî –¢–µ—Å—Ç Logger Service</title>

  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>

  <!-- Bootstrap 4 CDN -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">

  <!-- –ü—Ä–∏–º–µ—Ä—ã CSS (–æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø—É—Ç—å –¥–ª—è service/logger/) -->
  <link rel="stylesheet" href="../../../examples/examples.css">

  <!-- Modia —Å—Ç–∏–ª–∏ -->
  <link rel="stylesheet" href="../../../modia/modia.css">
</head>

<body>
  <div class="container mt-5">
    <h1>üß™ –¢–µ—Å—Ç Logger Service</h1>
    <p class="lead">–ü—Ä–æ–≤–µ—Ä–∫–∞: –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∞–∫—Ç–∏–≤–Ω–æ–º —Ä–µ–∂–∏–º–µ.</p>

    <!-- –¢–µ–∫—É—â–∏–π —Ä–µ–∂–∏–º -->
    <div class="alert alert-info mt-3">
      <strong>üìç –¢–µ–∫—É—â–∏–π —Ä–µ–∂–∏–º:</strong> <span id="current-mode">–ù–µ –∞–∫—Ç–∏–≤–µ–Ω</span>
    </div>

    <!-- ========================================================================
    –°–µ–∫—Ü–∏—è 1: –ë–∞–∑–æ–≤–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
    ======================================================================== -->
    <div class="test-section">
      <h3>üìç –°–µ–∫—Ü–∏—è 1: –ë–∞–∑–æ–≤–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ</h3>

      <div class="expected-result">
        <h4>‚úÖ –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:</h4>
        <ul>
          <li><strong>–ë–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞:</strong> –∫–æ–Ω—Å–æ–ª—å –º–æ–ª—á–∏—Ç</li>
          <li><strong>?modia-log:</strong> –≤—Å–µ –ª–æ–≥–∏ –≤–∏–¥–Ω—ã –≤ –∫–æ–Ω—Å–æ–ª–∏</li>
          <li><strong>?modia-debug:</strong> –≤—Å–µ –ª–æ–≥–∏ –≤–∏–¥–Ω—ã –≤ –∫–æ–Ω—Å–æ–ª–∏</li>
          <li>–§–æ—Ä–º–∞—Ç: <code>[HH:MM:SS] [Modia] [Context] Message</code></li>
          <li>–£—Ä–æ–≤–Ω–∏ warn/error –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ console –º–µ—Ç–æ–¥—ã</li>
        </ul>
      </div>

      <div class="test-buttons">
        <button id="test-info" class="btn btn-info">üìù Info</button>
        <button id="test-warn" class="btn btn-warning">‚ö†Ô∏è Warn</button>
        <button id="test-error" class="btn btn-danger">‚ùå Error</button>
        <button id="test-success" class="btn btn-success">‚úÖ Success</button>
        <button id="test-silence" class="btn btn-secondary">üîá –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏—à–∏–Ω—ã</button>
      </div>

      <div id="basic-test-result" class="test-result pending">–û–∂–∏–¥–∞–Ω–∏–µ...</div>
    </div>

    <!-- ========================================================================
    –°–µ–∫—Ü–∏—è 2: –°—Å—ã–ª–∫–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
    ======================================================================== -->
    <div class="test-section">
      <h3>üîó –°—Å—ã–ª–∫–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:</h3>
      <div class="test-buttons">
        <a href="test-01-basic.html" class="btn btn-secondary">–ë–µ–∑ —Ä–µ–∂–∏–º–∞</a>
        <a href="test-01-basic.html?modia-log" class="btn btn-success">?modia-log</a>
        <a href="test-01-basic.html?modia-debug" class="btn btn-primary">?modia-debug</a>
      </div>
    </div>

    <!-- ========================================================================
    –°–µ–∫—Ü–∏—è 3: ENV-–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ (—É—Ä–æ–≤–µ–Ω—å 1)
    ======================================================================== -->
    <div class="test-section">
      <h3>üîß ENV-–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ (—É—Ä–æ–≤–µ–Ω—å 1)</h3>

      <div class="expected-result">
        <h4>‚úÖ –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:</h4>
        <ul>
          <li>–° <code>MODIA_LOG_ENABLED = false</code> ‚Äî –∫–æ–Ω—Å–æ–ª—å –º–æ–ª—á–∏—Ç</li>
          <li>–° <code>MODIA_LOG_LEVEL = 'error'</code> ‚Äî —Ç–æ–ª—å–∫–æ error –ø—Ä–æ—Ö–æ–¥–∏—Ç</li>
        </ul>
      </div>

      <div class="test-buttons">
        <button id="btn-env-block" class="btn btn-warning">–¢–µ—Å—Ç –ø–æ–ª–Ω–æ–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏</button>
        <button id="btn-env-level" class="btn btn-info">–¢–µ—Å—Ç —É—Ä–æ–≤–Ω—è –ª–æ–≥–æ–≤</button>
      </div>

      <div id="env-test-result" class="test-result pending">–û–∂–∏–¥–∞–Ω–∏–µ...</div>
    </div>

    <!-- ========================================================================
    –°–∫—Ä–∏–ø—Ç—ã
    ======================================================================== -->
    <script type="module">
      import { logger } from '../../../modia/services/logger.js';

      // –≠–∫—Å–ø–æ—Ä—Ç logger –¥–ª—è –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ (ENV —Ç–µ—Å—Ç—ã)
      window.logger = logger;

      // ========================================================================
      // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ —Ä–µ–∂–∏–º–∞
      // ========================================================================
      function updateModeDisplay() {
        const urlParams = new URLSearchParams(window.location.search);
        const hasLog = urlParams.has('modia-log');
        const hasDebug = urlParams.has('modia-debug');
        const hasDataAttr = $('[data-modia-log]').length > 0 || $('[data-modia-debug]').length > 0;

        let mode = '–ù–µ –∞–∫—Ç–∏–≤–µ–Ω';
        if (hasLog) mode = 'modia-log (GET)';
        if (hasDebug) mode = 'modia-debug (GET)';
        if (hasDataAttr) mode = 'data-modia-* (–∞—Ç—Ä–∏–±—É—Ç)';

        $('#current-mode').text(mode);
      }

      // ========================================================================
      // –ë–∞–∑–æ–≤—ã–µ —Ç–µ—Å—Ç—ã –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
      // ========================================================================
      $('#test-info').on('click', () => {
        logger.info('–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ', 'TestButton');
        $('#basic-test-result').removeClass('pending').addClass('pass').text('‚úÖ Info –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –≤ –∫–æ–Ω—Å–æ–ª—å');
      });

      $('#test-warn').on('click', () => {
        logger.warn('–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ', 'TestButton');
        $('#basic-test-result').removeClass('pending').addClass('pass').text('‚úÖ Warn –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –≤ –∫–æ–Ω—Å–æ–ª—å');
      });

      $('#test-error').on('click', () => {
        logger.error('–û—à–∏–±–∫–∞', 'TestButton');
        $('#basic-test-result').removeClass('pending').addClass('pass').text('‚úÖ Error –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –≤ –∫–æ–Ω—Å–æ–ª—å');
      });

      $('#test-success').on('click', () => {
        logger.success('–£—Å–ø–µ—Ö', 'TestButton');
        $('#basic-test-result').removeClass('pending').addClass('pass').text('‚úÖ Success –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –≤ –∫–æ–Ω—Å–æ–ª—å');
      });

      $('#test-silence').on('click', () => {
        console.log('--- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏—à–∏–Ω—ã ---');

        // –í—Ä–µ–º–µ–Ω–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
        const wasEnabled = window.MODIA_LOG_ENABLED;
        window.MODIA_LOG_ENABLED = false;

        logger.info('–≠—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –ù–ï –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è (—Ç–∏—à–∏–Ω–∞)');

        // –°–±—Ä–æ—Å
        window.MODIA_LOG_ENABLED = wasEnabled;

        console.log('--- –ö–æ–Ω–µ—Ü –ø—Ä–æ–≤–µ—Ä–∫–∏ ---');
        console.log('‚úÖ –¢–∏—à–∏–Ω–∞ —Å–æ–±–ª—é–¥–µ–Ω–∞');

        $('#basic-test-result').removeClass('pending').addClass('pass').text('‚úÖ –¢–∏—à–∏–Ω–∞ —Å–æ–±–ª—é–¥–µ–Ω–∞');
      });

      // ========================================================================
      // ENV-–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Ç–µ—Å—Ç—ã
      // ========================================================================
      $('#btn-env-block').on('click', function () {
        console.log('--- –¢–µ—Å—Ç ENV –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ ---');

        // –°–∏–º—É–ª—è—Ü–∏—è ENV-–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
        window.MODIA_LOG_ENABLED = false;
        logger.info('–≠—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –ù–ï –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è (ENV –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞)');

        // –°–±—Ä–æ—Å
        window.MODIA_LOG_ENABLED = undefined;
        logger.info('ENV –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Å–Ω—è—Ç–∞ ‚Äî —ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è');

        $('#env-test-result')
          .removeClass('pending')
          .addClass('pass')
          .text('‚úÖ ENV –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç');
      });

      $('#btn-env-level').on('click', function () {
        console.log('--- –¢–µ—Å—Ç —É—Ä–æ–≤–Ω—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è ---');

        // –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å 'error'
        window.MODIA_LOG_LEVEL = 'error';

        logger.info('info ‚Äî –ù–ï –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è');
        logger.warn('warn ‚Äî –ù–ï –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è');
        logger.error('error ‚Äî –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è');
        logger.success('success ‚Äî –ù–ï –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è');

        // –°–±—Ä–æ—Å
        window.MODIA_LOG_LEVEL = undefined;
        logger.info('–£—Ä–æ–≤–µ–Ω—å —Å–±—Ä–æ—à–µ–Ω ‚Äî –≤—Å–µ –ª–æ–≥–∏ —Ä–∞–±–æ—Ç–∞—é—Ç');

        $('#env-test-result')
          .removeClass('pending')
          .addClass('pass')
          .text('‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —É—Ä–æ–≤–Ω—é —Ä–∞–±–æ—Ç–∞–µ—Ç');
      });

      // ========================================================================
      // –ê–≤—Ç–æ-–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
      // ========================================================================
      $(document).ready(() => {
        setTimeout(() => {
          updateModeDisplay();
          logger.info('Logger –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω', 'Test-01');
          logger.success('–¢–µ—Å—Ç –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ', 'Test-01');
        }, 500);
      });
    </script>
  </div>
</body>

</html>