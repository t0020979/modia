<!DOCTYPE html>
<html lang="ru">

<head>
  <meta charset="UTF-8">
  <title>Modia ‚Äî –¢–µ—Å—Ç Logger</title>
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="../modia/modia.css">
  <!-- ‚ö†Ô∏è –ù–ï–¢ data-modia-* –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –Ω–∞ body -->
</head>

<body>
  <div class="container mt-5">
    <h1>üß™ –¢–µ—Å—Ç Logger Service</h1>
    <p class="lead">–ü—Ä–æ–≤–µ—Ä–∫–∞: –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∞–∫—Ç–∏–≤–Ω–æ–º —Ä–µ–∂–∏–º–µ.</p>

    <div class="alert alert-info mt-3">
      <strong>üìç –¢–µ–∫—É—â–∏–π —Ä–µ–∂–∏–º:</strong> <span id="current-mode">–ù–µ –∞–∫—Ç–∏–≤–µ–Ω</span>
    </div>

    <div class="test-buttons mt-4">
      <button id="test-info" class="btn btn-info mr-2">üìù Info</button>
      <button id="test-warn" class="btn btn-warning mr-2">‚ö†Ô∏è Warn</button>
      <button id="test-error" class="btn btn-danger mr-2">‚ùå Error</button>
      <button id="test-success" class="btn btn-success mr-2">‚úÖ Success</button>
      <button id="test-silence" class="btn btn-secondary">üîá –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏—à–∏–Ω—ã</button>
    </div>

    <hr class="my-5">
    <h3>‚úÖ –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:</h3>
    <ul>
      <li><strong>–ë–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞:</strong> –∫–æ–Ω—Å–æ–ª—å –º–æ–ª—á–∏—Ç (–∫—Ä–æ–º–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–∏—à–∏–Ω—ã)</li>
      <li><strong>?modia-log:</strong> –≤—Å–µ –ª–æ–≥–∏ –≤–∏–¥–Ω—ã –≤ –∫–æ–Ω—Å–æ–ª–∏</li>
      <li><strong>?modia-debug:</strong> –≤—Å–µ –ª–æ–≥–∏ –≤–∏–¥–Ω—ã –≤ –∫–æ–Ω—Å–æ–ª–∏</li>
      <li>–§–æ—Ä–º–∞—Ç: <code>[HH:MM:SS] [Modia] [Context] Message</code></li>
      <li>–£—Ä–æ–≤–Ω–∏ warn/error –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ console –º–µ—Ç–æ–¥—ã</li>
    </ul>

    <h3>üîó –°—Å—ã–ª–∫–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:</h3>
    <div class="mt-3">
      <a href="test-01-logger.html" class="btn btn-secondary mr-2">–ë–µ–∑ —Ä–µ–∂–∏–º–∞</a>
      <a href="test-01-logger.html?modia-log" class="btn btn-success mr-2">?modia-log</a>
      <a href="test-01-logger.html?modia-debug" class="btn btn-primary">?modia-debug</a>
    </div>
  </div>

  <script type="module">
    import { logger } from '../modia/services/logger.js';

    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–µ–∫—É—â–∏–π —Ä–µ–∂–∏–º
    function updateModeDisplay() {
      const urlParams = new URLSearchParams(window.location.search);
      const hasLog = urlParams.has('modia-log');
      const hasDebug = urlParams.has('modia-debug');
      const hasDataAttr = $('[data-modia-log]').length > 0 || $('[data-modia-debug]').length > 0;

      let mode = '–ù–µ –∞–∫—Ç–∏–≤–µ–Ω';
      if (hasLog) mode = 'modia-log (GET)';
      if (hasDebug) mode = 'modia-debug (GET)';
      if (hasDataAttr) mode = 'data-modia-* (–∞—Ç—Ä–∏–±—É—Ç)';

      $('#current-mode').text(mode);
    }

    $('#test-info').on('click', () => {
      logger.info('–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ', 'TestButton');
    });

    $('#test-warn').on('click', () => {
      logger.warn('–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ', 'TestButton');
    });

    $('#test-error').on('click', () => {
      logger.error('–û—à–∏–±–∫–∞', 'TestButton');
    });

    $('#test-success').on('click', () => {
      logger.success('–£—Å–ø–µ—Ö', 'TestButton');
    });

    $('#test-silence').on('click', () => {
      console.log('--- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏—à–∏–Ω—ã ---');
      logger.info('–≠—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –ù–ï –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è (–Ω–µ—Ç —Ä–µ–∂–∏–º–∞)');
      console.log('--- –ö–æ–Ω–µ—Ü –ø—Ä–æ–≤–µ—Ä–∫–∏ ---');

      if ($('.log-entry').length === 0) {
        console.log('‚úÖ –¢–∏—à–∏–Ω–∞ —Å–æ–±–ª—é–¥–µ–Ω–∞');
      }
    });

    // –ê–≤—Ç–æ-—Ç–µ—Å—Ç –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
    setTimeout(() => {
      updateModeDisplay();
      logger.info('Logger –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω', 'Test-01');
      logger.success('–¢–µ—Å—Ç –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ', 'Test-01');
    }, 500);
  </script>
</body>

</html>