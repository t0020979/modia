<!DOCTYPE html>
<html lang="ru">

<head>
  <meta charset="UTF-8">
  <title>Modia ‚Äî –¢–µ—Å—Ç validation-rules.js: –ü–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</title>

  <!-- ‚úÖ jQuery CDN (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û) -->
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>

  <!-- ‚úÖ Bootstrap 4 CDN -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">

  <!-- ‚úÖ –ü—Ä–∏–º–µ—Ä—ã CSS (2 —É—Ä–æ–≤–Ω—è –≤–≤–µ—Ä—Ö) -->
  <link rel="stylesheet" href="../../examples.css">

  <!-- ‚úÖ Modia CSS -->
  <link rel="stylesheet" href="../../../modia/modia.css">

  <style>
    .console-log {
      background: #1e1e1e;
      color: #00ff00;
      padding: 15px;
      border-radius: 5px;
      max-height: 300px;
      overflow-y: auto;
      font-family: monospace;
      font-size: 12px;
    }

    .pass {
      color: #28a745;
      font-weight: bold;
    }

    .fail {
      color: #dc3545;
      font-weight: bold;
    }

    .info {
      color: #17a2b8;
    }

    .warning {
      color: #ffc107;
    }

    .instruction-box {
      background: #e7f3ff;
      border-left: 4px solid #007bff;
      padding: 10px;
      margin: 10px 0;
      font-size: 13px;
    }

    .expected-result {
      background: #d4edda;
      border-left: 4px solid #28a745;
      padding: 10px;
      margin: 10px 0;
    }

    .auto-test-running {
      animation: pulse 1s infinite;
    }

    @keyframes pulse {

      0%,
      100% {
        opacity: 1
      }

      50% {
        opacity: 0.5
      }
    }
  </style>
</head>

<body>
  <div class="container mt-4">
    <h3>üß™ –¢–µ—Å—Ç validation-rules.js: –ü–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</h3>

    <!-- –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã -->
    <div class="expected-result mb-3">
      <h4>‚úÖ –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:</h4>
      <ul class="mb-0">
        <li><code>formatMessage()</code> –∑–∞–º–µ–Ω—è–µ—Ç —Ç–æ–ª—å–∫–æ <code>__PLACEHOLDER__</code></li>
        <li>–°–ª–æ–≤–∞ –±–µ–∑ <code>__</code> –ù–ï –∑–∞–º–µ–Ω—è—é—Ç—Å—è</li>
        <li>–í—Å–µ <code>defaultMessage</code> –≤ –ø—Ä–∞–≤–∏–ª–∞—Ö –∏–º–µ—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ã</li>
        <li>–ü–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç case-insensitive</li>
        <li>–ù–µ–ø–æ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ—Å—Ç–∞—é—Ç—Å—è –∫–∞–∫ –µ—Å—Ç—å</li>
      </ul>
    </div>

    <!-- –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
    <div class="mb-3">
      <button class="btn btn-success" id="btn-run">‚ñ∂Ô∏è –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã</button>
      <button class="btn btn-secondary" id="btn-clear">üßπ –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥</button>
      <button class="btn btn-info" id="btn-auto">‚ñ∂Ô∏è –ê–≤—Ç–æ-—Ç–µ—Å—Ç</button>
    </div>

    <!-- –õ–æ–≥ -->
    <div class="console-log" id="console-log"><small>[00:00:00] –ö–æ–Ω—Å–æ–ª—å –≥–æ—Ç–æ–≤–∞...</small></div>

    <!-- –°—Ç–∞—Ç—É—Å -->
    <div class="mt-2" id="status"><strong>–°—Ç–∞—Ç—É—Å:</strong> –û–∂–∏–¥–∞–Ω–∏–µ...</div>
  </div>

  <script type="module">
    import { validationRules, isEmpty, formatMessage, normalizeValue } from '../../../modia/configurations/validation-rules.js';

    // ========================================================================
    // –£–¢–ò–õ–ò–¢–´ –¢–ï–°–¢–ê
    // ========================================================================

    function log(msg, type = 'info') {
      const $log = $('#console-log');
      const ts = new Date().toLocaleTimeString('ru-RU');
      const cls = type === 'pass' ? 'pass' : type === 'fail' ? 'fail' : type === 'warning' ? 'warning' : 'info';
      $log.append(`<div class="${cls}"><small>[${ts}] ${msg}</small></div>`);
      $log.scrollTop($log[0].scrollHeight);
      console.log(`[Test] ${msg}`);
    }

    function assert(cond, msg) {
      if (cond) {
        log(`‚úÖ ${msg}`, 'pass');
        return true;
      } else {
        log(`‚ùå ${msg}`, 'fail');
        return false;
      }
    }

    function sleep(ms) {
      return new Promise(resolve => setTimeout(resolve, ms));
    }

    function updateStatus(text) {
      $('#status').html(`<strong>–°—Ç–∞—Ç—É—Å:</strong> ${text}`);
    }

    // ========================================================================
    // –¢–ï–°–¢ 1: formatMessage() –Ω–µ –∑–∞–º–µ–Ω—è–µ—Ç —Å–ª–æ–≤–∞ –±–µ–∑ __
    // ========================================================================

    function testNoFalseReplacements() {
      log('--- –¢–µ—Å—Ç 1: –°–ª–æ–≤–∞ –±–µ–∑ __ –ù–ï –∑–∞–º–µ–Ω—è—é—Ç—Å—è ---', 'info');
      let passed = 0;
      const total = 4;

      // –ö–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (–∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º)
      let result = formatMessage('Hello __NAME__', { name: 'Alex', hello: '–ü—Ä–∏–≤–µ—Ç' });
      assert(result === 'Hello Alex', 'Hello –Ω–µ –∑–∞–º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ "–ü—Ä–∏–≤–µ—Ç"'); passed++;

      // –ù–µ—Å–∫–æ–ª—å–∫–æ —Å–ª–æ–≤, –æ–¥–Ω–æ —Å __, –¥—Ä—É–≥–æ–µ –±–µ–∑
      result = formatMessage('Count __COUNT__ items', { count: 5, items: '—à—Ç—É–∫' });
      assert(result === 'Count 5 items', 'items –Ω–µ –∑–∞–º–µ–Ω—è–µ—Ç—Å—è'); passed++;

      // –®–∞–±–ª–æ–Ω –±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
      result = formatMessage('Static text', { static: '–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π', text: '–¢–µ–∫—Å—Ç' });
      assert(result === 'Static text', '–°—Ç–∞—Ç–∏—á–Ω—ã–π —Ç–µ–∫—Å—Ç –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è'); passed++;

      // –ß–∞—Å—Ç–∏—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ
      result = formatMessage('__COUNT__ of __TOTAL__', { count: 5, total: 10, countof: 'X' });
      assert(result === '5 of 10', 'countof –Ω–µ –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –≤–º–µ—Å—Ç–æ COUNT'); passed++;

      log(`–°–ª–æ–≤–∞ –±–µ–∑ __: ${passed}/${total} —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ–π–¥–µ–Ω–æ`, passed === total ? 'pass' : 'fail');
      return passed === total;
    }

    // ========================================================================
    // –¢–ï–°–¢ 2: formatMessage() –∑–∞–º–µ–Ω—è–µ—Ç —Ç–æ–ª—å–∫–æ __PLACEHOLDER__
    // ========================================================================

    function testCorrectPlaceholders() {
      log('--- –¢–µ—Å—Ç 2: __PLACEHOLDER__ –∑–∞–º–µ–Ω—è–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ ---', 'info');
      let passed = 0;
      const total = 5;

      // –ë–∞–∑–æ–≤–∞—è –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞
      let result = formatMessage('Max: __COUNT__', { count: 10 });
      assert(result === 'Max: 10', '__COUNT__ ‚Üí 10'); passed++;

      // Case-insensitive
      result = formatMessage('Max: __count__', { COUNT: 10 });
      assert(result === 'Max: 10', '__count__ ‚Üí {COUNT:10}'); passed++;
      result = formatMessage('Max: __Count__', { count: 10 });
      assert(result === 'Max: 10', '__Count__ ‚Üí {count:10}'); passed++;

      // –ù–µ—Å–∫–æ–ª—å–∫–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
      result = formatMessage('__MIN__ ‚â§ __CURRENT__ ‚â§ __MAX__', { min: 1, current: 5, max: 10 });
      assert(result === '1 ‚â§ 5 ‚â§ 10', '–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞'); passed++;

      // –ù–µ–ø–æ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä –æ—Å—Ç–∞—ë—Ç—Å—è
      result = formatMessage('Value: __MISSING__', { other: 'test' });
      assert(result === 'Value: __MISSING__', '–ù–µ–ø–æ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä –æ—Å—Ç–∞—ë—Ç—Å—è'); passed++;

      log(`__PLACEHOLDER__: ${passed}/${total} —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ–π–¥–µ–Ω–æ`, passed === total ? 'pass' : 'fail');
      return passed === total;
    }

    // ========================================================================
    // –¢–ï–°–¢ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ defaultMessage –≤ –ø—Ä–∞–≤–∏–ª–∞—Ö
    // ========================================================================

    function testDefaultMessagePlaceholders() {
      log('--- –¢–µ—Å—Ç 3: defaultMessage –≤ –ø—Ä–∞–≤–∏–ª–∞—Ö ---', 'info');
      let passed = 0;
      const total = validationRules.length;

      validationRules.forEach(rule => {
        if (!rule.defaultMessage) {
          log(`‚ö†Ô∏è –ü—Ä–∞–≤–∏–ª–æ "${rule.name}": –Ω–µ—Ç defaultMessage`, 'warning');
          passed++;
          return;
        }

        const msg = rule.defaultMessage;
        const hasPlaceholders = /__[A-Z_]+__/i.test(msg);
        const params = rule.name === 'max-length' || rule.name === 'min-length' ? ['COUNT'] : [];

        if (params.length > 0 && !hasPlaceholders) {
          log(`‚ùå –ü—Ä–∞–≤–∏–ª–æ "${rule.name}": —Ç—Ä–µ–±—É–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã ${params.join(', ')}, –Ω–æ –Ω–µ—Ç –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä–æ–≤`, 'fail');
        } else if (params.length > 0) {
          log(`‚úÖ –ü—Ä–∞–≤–∏–ª–æ "${rule.name}": –∏–º–µ–µ—Ç –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ã`, 'pass');
          passed++;
        } else {
          log(`‚úÖ –ü—Ä–∞–≤–∏–ª–æ "${rule.name}": –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤`, 'pass');
          passed++;
        }
      });

      log(`defaultMessage: ${passed}/${total} –ø—Ä–∞–≤–∏–ª –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ`, passed === total ? 'pass' : 'fail');
      return passed === total;
    }

    // ========================================================================
    // –¢–ï–°–¢ 4: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏ (—Ä–µ–∞–ª—å–Ω–∞—è –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞)
    // ========================================================================

    function testIntegrationWithRules() {
      log('--- –¢–µ—Å—Ç 4: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏ ---', 'info');
      let passed = 0;
      const total = 3;

      // max-length —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
      const maxRule = validationRules.find(r => r.name === 'max-length');
      if (maxRule) {
        const msg = typeof maxRule.defaultMessage === 'function'
          ? maxRule.defaultMessage({ count: 10 })
          : maxRule.defaultMessage;
        const formatted = formatMessage(msg, { count: 10 });
        assert(formatted.includes('10'), 'max-length: –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ COUNT —Ä–∞–±–æ—Ç–∞–µ—Ç'); passed++;
      }

      // min-length —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
      const minRule = validationRules.find(r => r.name === 'min-length');
      if (minRule) {
        const msg = typeof minRule.defaultMessage === 'function'
          ? minRule.defaultMessage({ count: 5 })
          : minRule.defaultMessage;
        const formatted = formatMessage(msg, { count: 5 });
        assert(formatted.includes('5'), 'min-length: –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ COUNT —Ä–∞–±–æ—Ç–∞–µ—Ç'); passed++;
      }

      // required –±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
      const reqRule = validationRules.find(r => r.name === 'required');
      if (reqRule) {
        const msg = reqRule.defaultMessage;
        assert(typeof msg === 'string' && msg.length > 0, 'required: defaultMessage –µ—Å—Ç—å'); passed++;
      }

      log(`–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è: ${passed}/${total} —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ–π–¥–µ–Ω–æ`, passed === total ? 'pass' : 'fail');
      return passed === total;
    }

  // ========================================================================
  // –¢–ï–°–¢ 5: –ö—Ä–∞–π–Ω–∏–µ —Å–ª—É—á–∞–∏
  // ========================================================================

  function testEdgeCases() {
    log('--- –¢–µ—Å—Ç 5: –ö—Ä–∞–π–Ω–∏–µ —Å–ª—É—á–∞–∏ ---', 'info');
    let passed = 0;
    const total = 6;  // ‚Üê –ò–°–ü–†–ê–í–õ–ï–ù–û: –±—ã–ª–æ 5, —Å—Ç–∞–ª–æ 6 —Ç–µ—Å—Ç–æ–≤

    // 1. –ü—É—Å—Ç–æ–π —à–∞–±–ª–æ–Ω
    assert(formatMessage('', { x: 1 }) === '', '–ü—É—Å—Ç–æ–π —à–∞–±–ª–æ–Ω'); passed++;

    // 2. Null params
    assert(formatMessage('Test', null) === 'Test', 'null params'); passed++;

    // 3. Undefined params
    assert(formatMessage('Test', undefined) === 'Test', 'undefined params'); passed++;

    // 4. –î—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ã
    const result = formatMessage('__A__ + __A__ = __B__', { a: 2, b: 4 });
    assert(result === '2 + 2 = 4', '–î—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ã'); passed++;

    // 5. –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã –≤ –∑–Ω–∞—á–µ–Ω–∏–∏ (XSS-–≤–µ–∫—Ç–æ—Ä)
    // ‚ö†Ô∏è –ò—Å–ø–æ–ª—å–∑—É–µ–º template literal –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è —Ä–∞–∑—Ä—ã–≤–∞ —Å—Ç—Ä–æ–∫–∏
    const xssPayload = '<script>alert(1)<\/script>';
    const result2 = formatMessage('Value: __VAL__', { val: xssPayload });
    assert(result2.includes('\
  <script>'), '–°–ø–µ—Ü—Å–∏–º–≤–æ–ª—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è(XSS - –≤–µ–∫—Ç–æ—Ä)'); passed++;

    // 6. HTML-—Å—É—â–Ω–æ—Å—Ç–∏
    const htmlEntities = '&lt;div&gt;';
    const result3 = formatMessage('HTML: __HTML__', { html: htmlEntities });
    assert(result3.includes('&lt;'), 'HTML-—Å—É—â–Ω–æ—Å—Ç–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è'); passed++;

    log(`–ö—Ä–∞–π–Ω–∏–µ —Å–ª—É—á–∞–∏: ${passed}/${total} —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ–π–¥–µ–Ω–æ`, passed === total ? 'pass' : 'fail');
    return passed === total;
}

    // ========================================================================
    // –¢–ï–°–¢ 6: –ù–µ–≥–∞—Ç–∏–≤–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
    // ========================================================================
    
    function testNegativeScenarios() {
          log('--- –¢–µ—Å—Ç 6: –ù–µ–≥–∞—Ç–∏–≤–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ ---', 'info');
          let passed = 0;
          const total = 6;

          // 1. –ü—É—Å—Ç–æ–π —à–∞–±–ª–æ–Ω
          try {
            const result = formatMessage('', { x: 1 });
            assert(result === '', '–ü—É—Å—Ç–æ–π —à–∞–±–ª–æ–Ω ‚Üí –ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞'); passed++;
          } catch (e) {
            assert(false, '–ü—É—Å—Ç–æ–π —à–∞–±–ª–æ–Ω ‚Üí –æ—à–∏–±–∫–∞ (–Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å)');
          }

          // 2. Null –≤–º–µ—Å—Ç–æ —à–∞–±–ª–æ–Ω–∞
          try {
            const result = formatMessage(null, { x: 1 });
            assert(result === null, 'Null —à–∞–±–ª–æ–Ω ‚Üí null'); passed++;
          } catch (e) {
            assert(false, 'Null —à–∞–±–ª–æ–Ω ‚Üí –æ—à–∏–±–∫–∞ (–Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å)');
          }

          // 3. Undefined –≤–º–µ—Å—Ç–æ params
          try {
            const result = formatMessage('Test __X__', undefined);
            assert(result === 'Test __X__', 'Undefined params ‚Üí —à–∞–±–ª–æ–Ω –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π'); passed++;
          } catch (e) {
            assert(false, 'Undefined params ‚Üí –æ—à–∏–±–∫–∞ (–Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å)');
          }

          // 4. –ü—É—Å—Ç—ã–µ params
          try {
            const result = formatMessage('Test __X__', {});
            assert(result === 'Test __X__', '–ü—É—Å—Ç—ã–µ params ‚Üí —à–∞–±–ª–æ–Ω –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π'); passed++;
          } catch (e) {
            assert(false, '–ü—É—Å—Ç—ã–µ params ‚Üí –æ—à–∏–±–∫–∞ (–Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å)');
          }

          // 5. HTML-—Ç–µ–≥–∏ –≤ –∑–Ω–∞—á–µ–Ω–∏–∏ (–Ω–µ —ç–∫—Ä–∞–Ω–∏—Ä—É—é—Ç—Å—è)
          try {
            const result = formatMessage('Value: __VAL__', {
              val: '<script>alert(1)<\/script>' });
  assert(result.includes('\
  <script>'), 'HTML - —Ç–µ–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è(–Ω–µ —ç–∫—Ä–∞–Ω–∏—Ä—É—é—Ç—Å—è)'); passed++;
      } catch (e) {
              assert(false, 'HTML-—Ç–µ–≥–∏ ‚Üí –æ—à–∏–±–∫–∞ (–Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å)');
            }

            // 6. –°–ø–µ—Ü—Å–∏–º–≤–æ–ª—ã –≤ –∑–Ω–∞—á–µ–Ω–∏–∏
            try {
              const result = formatMessage('Value: __VAL__', { val: '&<>"\'' });
              assert(result.includes('&'), '–°–ø–µ—Ü—Å–∏–º–≤–æ–ª—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è'); passed++;
            } catch (e) {
              assert(false, '–°–ø–µ—Ü—Å–∏–º–≤–æ–ª—ã ‚Üí –æ—à–∏–±–∫–∞ (–Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å)');
            }

            log(`–ù–µ–≥–∞—Ç–∏–≤–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏: ${passed}/${total} —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ–π–¥–µ–Ω–æ`, passed === total ? 'pass' : 'fail');
            return passed === total;
          }

    // ========================================================================
    // –ó–ê–ü–£–°–ö –¢–ï–°–¢–û–í
    // ========================================================================
    
    async function runAllTests() {
            updateStatus('üîÑ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤...');
            log('=== –ó–ê–ü–£–°–ö –¢–ï–°–¢–û–í: –ü–û–î–°–¢–ê–ù–û–í–ö–ê –ü–ê–†–ê–ú–ï–¢–†–û–í ===', 'info');

            const results = [
              testNoFalseReplacements(),
              await sleep(100).then(() => testCorrectPlaceholders()),
              await sleep(100).then(() => testDefaultMessagePlaceholders()),
              await sleep(100).then(() => testIntegrationWithRules()),
              await sleep(100).then(() => testEdgeCases()),
              await sleep(100).then(() => testNegativeScenarios())
            ];

            const total = results.filter(r => r).length;
            log(`=== –ò–¢–û–ì–û: ${total}/6 –≥—Ä—É–ø–ø —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ–π–¥–µ–Ω–æ ===`, total === 6 ? 'pass' : 'fail');
            updateStatus(total === 6 ? '‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã' : '‚ùå –ï—Å—Ç—å –æ—à–∏–±–∫–∏');

            return total === 6;
          }

          // ========================================================================
          // –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –°–û–ë–´–¢–ò–ô
          // ========================================================================

          $('#btn-run').on('click', runAllTests);

          $('#btn-clear').on('click', () => {
            $('#console-log').html('<small>[00:00:00] –ö–æ–Ω—Å–æ–ª—å –≥–æ—Ç–æ–≤–∞...</small>');
            updateStatus('–û–∂–∏–¥–∞–Ω–∏–µ...');
            log('–õ–æ–≥ –æ—á–∏—â–µ–Ω', 'info');
          });

          $('#btn-auto').on('click', async () => {
            $('#btn-auto').prop('disabled', true);
            await runAllTests();
            await sleep(500);
            $('#btn-auto').prop('disabled', false);
          });

          // –ê–≤—Ç–æ-–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
          $(document).ready(() => {
            log('‚úÖ jQuery –∑–∞–≥—Ä—É–∂–µ–Ω', 'pass');
            log('‚úÖ validationRules –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω', 'pass');
            updateStatus('–ì–æ—Ç–æ–≤ –∫ —Ç–µ—Å—Ç–∞–º');
          });
  </script>
</body>

</html>